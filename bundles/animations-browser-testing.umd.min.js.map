{"version":3,"file":"animations-browser-testing.umd.min.js","sources":["../../../../packages/animations/browser/testing/src/mock_animation_driver.ts","../../../../packages/animations/browser/testing/src/testing.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport {AUTO_STYLE, AnimationPlayer, NoopAnimationPlayer, ɵStyleData} from '@angular/animations';\n\nimport {AnimationDriver} from '../../src/render/animation_driver';\n\n/**\n * @experimental Animation support is experimental.\n */\nexport class MockAnimationDriver implements AnimationDriver {\n  static log: AnimationPlayer[] = [];\n\n  computeStyle(element: any, prop: string, defaultValue?: string): string {\n    return defaultValue || '';\n  }\n\n  animate(\n      element: any, keyframes: {[key: string]: string | number}[], duration: number, delay: number,\n      easing: string, previousPlayers: any[] = []): MockAnimationPlayer {\n    const player =\n        new MockAnimationPlayer(element, keyframes, duration, delay, easing, previousPlayers);\n    MockAnimationDriver.log.push(<AnimationPlayer>player);\n    return player;\n  }\n}\n\n/**\n * @experimental Animation support is experimental.\n */\nexport class MockAnimationPlayer extends NoopAnimationPlayer {\n  private __finished = false;\n  private __started = false;\n  public previousStyles: {[key: string]: string | number} = {};\n  private _onInitFns: (() => any)[] = [];\n  public currentSnapshot: ɵStyleData = {};\n\n  constructor(\n      public element: any, public keyframes: {[key: string]: string | number}[],\n      public duration: number, public delay: number, public easing: string,\n      public previousPlayers: any[]) {\n    super();\n    previousPlayers.forEach(player => {\n      if (player instanceof MockAnimationPlayer) {\n        const styles = player.currentSnapshot;\n        Object.keys(styles).forEach(prop => this.previousStyles[prop] = styles[prop]);\n      }\n    });\n\n    this.totalTime = delay + duration;\n  }\n\n  /* @internal */\n  onInit(fn: () => any) { this._onInitFns.push(fn); }\n\n  /* @internal */\n  init() {\n    super.init();\n    this._onInitFns.forEach(fn => fn());\n    this._onInitFns = [];\n  }\n\n  finish(): void {\n    super.finish();\n    this.__finished = true;\n  }\n\n  destroy(): void {\n    super.destroy();\n    this.__finished = true;\n  }\n\n  /* @internal */\n  triggerMicrotask() {}\n\n  play(): void {\n    super.play();\n    this.__started = true;\n  }\n\n  hasStarted() { return this.__started; }\n\n  beforeDestroy() {\n    const captures: ɵStyleData = {};\n\n    Object.keys(this.previousStyles).forEach(prop => {\n      captures[prop] = this.previousStyles[prop];\n    });\n\n    if (this.hasStarted()) {\n      // when assembling the captured styles, it's important that\n      // we build the keyframe styles in the following order:\n      // {other styles within keyframes, ... previousStyles }\n      this.keyframes.forEach(kf => {\n        Object.keys(kf).forEach(prop => {\n          if (prop != 'offset') {\n            captures[prop] = this.__finished ? kf[prop] : AUTO_STYLE;\n          }\n        });\n      });\n    }\n\n    this.currentSnapshot = captures;\n  }\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nexport {MockAnimationDriver, MockAnimationPlayer} from './mock_animation_driver';\n"],"names":["MockAnimationDriver","prototype","computeStyle","element","prop","defaultValue","previousPlayers","player","MockAnimationPlayer","keyframes","duration","delay","easing","log","push","_super","_this","call","this","__finished","__started","previousStyles","currentSnapshot","Object","keys","styles_1","forEach","__extends","onInit","fn","_onInitFns","init","finish","destroy","triggerMicrotask","play","beforeDestroy","hasStarted","kf"],"mappings":";;;;;wrBA4BAA,oBAAA,iDAbAA,qBAAAC,UAAAC,aAAA,SAAAC,QAAAC,KAAAC,+IAmBA,SAAAC,kBAAAA,mBAAA,IAAAC,QAAA,GAAAC,qBAAAL,QAAAM,UAAAC,SAAAC,MAAAC,OAAAN,uBAOAN,qBAAAa,IAAAC,KAAAP,sCAEAP,qBAAAa,MARA,IAAAL,qBAAA,SAAAO,QAEA,QAAAP,qBAAAL,QAAAM,UAAAC,SAAAC,MAAAC,OAAAN,iBACU,GAAVU,OAAAD,OAAAE,KAAAC,OAAAA,IA4BA,OA3BSF,OAATb,QAAAA,QAOIa,MAAJP,UAAAA,UACAO,MAAAN,SAAAA,SACAM,MAAAL,MAAAA,MACAK,MAAAJ,OAAAA,OACAI,MAAOV,gBAAPA,gBACAU,MAAAG,YAAA,EAEAH,MAAAI,WAAA,EACAJ,MAAAK,sCAGAL,MAAAM,4DAGA,GAAAf,iBAAAC,qBAAA,oCACAe,QAAAC,KAAAC,UAAAC,QAAA,SAAAtB,MAAA,MAAAY,OAAAK,eAAAjB,MAAAqB,SAAArB,0CAKAY,YA9BAW,WAAAnB,oBAAAO,QAiCAP,oBAAAP,UAAA2B,OAAA,SAAAC,IAAAX,KAAAY,WAAAhB,KAAAe,KAGArB,oBAAAP,UAAA8B,KAAA,WACIhB,OAAJd,UAAA8B,KAAAd,KAAAC,MACAA,KAAAY,WAAAJ,QAAA,SAAAG,IAAA,MAAAA,4BAKArB,oBAAAP,UAAA+B,OAAA,WACIjB,OAAJd,UAAA+B,OAAAf,KAAAC,MACAA,KAAAC,YAAA,GAGEX,oBAAFP,UAAAgC,QAAA,WAEAlB,OAAAd,UAAAgC,QAAAhB,KAAAC,MACIA,KAAJC,YAAA,GAIAX,oBAAAP,UAAAiC,iBAAA,aAEA1B,oBAAAP,UAAAkC,KAAA,WAAApB,OAAAd,UAAAkC,KAAAlB,KAAAC,oGAIAV,oBAAAP,UAAAmC,cAAA,WACA,GAAApB,OAAAE,qHAKAA,KAAAmB,cAKAnB,KAAAT,UAAAiB,QAAA,SAAAY,2CC5GA,UAAAlC"}