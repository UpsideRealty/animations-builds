{"version":3,"sources":["/home/travis/build/angular/angular/dist/packages-dist/animations/bundles/animations-browser.umd.js"],"names":["global","factory","exports","module","require","define","amd","ng","animations","browser","this","_angular_animations","__extends","d","b","__","constructor","extendStatics","prototype","Object","create","optimizeGroupPlayer","players","length","NoopAnimationPlayer","ɵAnimationGroupPlayer","normalizeKeyframes","driver","normalizer","element","keyframes","preStyles","postStyles","errors","normalizedKeyframes","previousOffset","previousKeyframe","forEach","kf","offset","isSameOffset","normalizedKeyframe","keys","prop","normalizedProp","normalizedValue","normalizePropertyName","ɵPRE_STYLE","AUTO_STYLE","normalizeStyleValue","push","Error","join","listenOnPlayer","player","eventName","event","callback","onStart","copyAnimationEvent","totalTime","onDone","onDestroy","e","phaseName","makeAnimationEvent","triggerName","fromState","toState","undefined","data","getOrSetAsInMap","map","key","defaultValue","value","Map","get","set","parseTimelineCommand","command","separatorPos","indexOf","substring","substr","validateStyleProperty","_CACHED_BODY","getBodyNode","style","document","body","resolveTimingValue","matches","match","_convertTimeValueToMS","parseFloat","unit","ONE_SECOND","resolveTiming","timings","allowNegativeValues","hasOwnProperty","parseTimeExpression","exp","duration","regex","delay","easing","delayMatch","Math","floor","easingVal","containsErrors","startIndex","splice","copyObj","obj","destination","normalizeStyles","styles","normalizedStyles","Array","isArray","copyStyles","readPrototype","setStyles","camelProp","dashCaseToCamelCase","eraseStyles","normalizeAnimationEntry","steps","sequence","validateStyleParams","options","params","extractStyleParams","varName","val","toString","PARAM_REGEX","exec","lastIndex","interpolateParams","original","str","replace","_","localVal","iteratorToArray","iterator","arr","item","next","done","input","DASH_CASE_REGEXP","m","_i","arguments","toUpperCase","allowPreviousPlayerStylesMerge","visitAnimationNode","visitor","node","context","type","visitTrigger","visitState","visitTransition","visitSequence","visitGroup","visitAnimate","visitKeyframes","visitStyle","visitReference","visitAnimateChild","visitAnimateRef","visitQuery","visitStagger","parseTransitionExpr","transitionValue","expressions","split","parseInnerTransitionStr","eventStr","result","parseAnimationAlias","separator","makeLambdaFromStates","isFullAnyStateExpr","ANY_STATE","alias","lhs","rhs","lhsMatch","rhsMatch","buildAnimationAst","metadata","AnimationAstBuilderVisitor","build","normalizeSelector","selector","hasAmpersand","find","token","SELF_TOKEN","SELF_TOKEN_REGEX","ENTER_TOKEN_REGEX","ENTER_SELECTOR","LEAVE_TOKEN_REGEX","LEAVE_SELECTOR","NG_TRIGGER_SELECTOR","NG_ANIMATING_SELECTOR","normalizeParams","consumeOffset","styleTuple","isObject","constructTimingAst","TimingAst","strValue","some","v","charAt","DynamicTimingAst","normalizeAnimationOptions","createTimelineInstruction","preStyleProps","postStyleProps","subTimeline","buildAnimationTimelines","rootElement","ast","startingStyles","finalStyles","subInstructions","AnimationTimelineBuilderVisitor","buildKeyframes","roundOffset","decimalPoints","mult","pow","round","flattenStyles","allStyles","allProperties","createTransitionInstruction","isRemovalTransition","fromStyles","toStyles","timelines","queriedElements","oneOrMoreTransitionsMatch","matchFns","currentState","nextState","fn","buildTrigger","name","AnimationTrigger","createFallbackTransition","states","matchers","animation","SequenceAst","transition","TransitionAst","AnimationTransitionFactory","balanceProperties","key1","key2","deleteOrUnsetInMap","currentValues","index","delete","normalizeTriggerValue","isElementNode","isTriggerEventValid","cloakElement","oldValue","display","cloakAndComputeStyles","elements","elementPropsMap","defaultStyle","cloakVals","valuesMap","failedElements","props","computeStyle","REMOVAL_FLAG","NULL_REMOVED_QUERIED_STATE","i","createIsRootFilterFn","nodes","isRoot","nodeSet","Set","knownRootContainer","has","parentNode","add","containsClass","className","classList","contains","classes","CLASSES_CACHE_KEY","addClass","removeClass","remove","removeNodesAfterAnimationDone","engine","processLeaveNode","flattenGroupPlayers","finalPlayers","_flattenGroupPlayersRecur","objEquals","a","k1","k2","replacePostStylesAsPre","allPreStyleElements","allPostStyleElements","postEntry","preEntry","_computeStyle","window","getComputedStyle","supportsWebAnimations","Element","setPrototypeOf","__proto__","p","__assign","assign","t","s","n","call","_contains","elm1","elm2","_matches","_query","multi","proto","fn_1","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","apply","results","querySelectorAll","elm","querySelector","matchesElement","containsElement","invokeQuery","NoopAnimationDriver","query","animate","previousPlayers","AnimationDriver","NOOP","RegExp","SUBSTITUTION_EXPR_START","EMPTY_ANIMATION_OPTIONS","Ast","defineProperty","enumerable","configurable","TriggerAst","_super","transitions","_this","queryCount","depCount","visit","StateAst","style$$1","GroupAst","AnimateAst","StyleAst","isEmptyStep","containsDynamicStyles","KeyframesAst","ReferenceAst","AnimateChildAst","AnimateRefAst","QueryAst","limit","optional","includeSelf","StaggerAst","visitTiming","_driver","AnimationAstBuilderContext","_resetContextStyleTimingState","currentQuerySelector","collectedStyles","currentTime","definitions","def","stateDef_1","name_1","styleAst","astParams","missingSubs_1","params_1","stylesObj_1","sub","size","missingSubsArr","values","stateAst","entry","expr","furthestTime","step","innerAst","max","timingAst","currentAnimateTimings","styleMetadata","styleMetadata_1","isEmpty","newStyleData","_makeStyleAst","_validateStyleAst","collectedEasing","styleData","styleMap","endTime","startTime","tuple","collectedEntry","updateCollectedStyle","totalKeyframesWithOffsets","offsets","offsetsOutOfOrder","keyframesOutOfRange","offsetVal","generatedOffset","animateDuration","durationUpToThisFrame","parentSelector","currentQuery","_a","originalSelector","currentTransition","ElementInstructionMap","_map","consume","instructions","append","existingInstructions","clear","AnimationTimelineContext","currentTimeline","filter","timeline","containsAnimation","tl","allowOnlyTimelineStyles","elementInstructions","innerContext","createSubContext","_visitSubInstructions","transformIntoNewTimeline","previousNode","instruction","instructionTimings","appendInstructionToTimeline","updateOptions","subContextCount","ctx","snapshotCurrentStyles","DEFAULT_NOOP_PREVIOUS_NODE","delayNextStep","applyStylesToKeyframe","innerTimelines","mergeTimelineCollectedStyles","incrementTime","getCurrentStyleProperties","forwardFrame","applyEmptyStep","innerTimeline","forwardTime","elms","currentQueryTotal","sameElementTimeline","currentQueryIndex","parentContext","abs","maxTime","currentStaggerTime","startingTime","initialTimeline","TimelineBuilder","skipIfExists","newOptions","optionsToUpdate","newParams","paramsToUpdate_1","_copyOptions","oldParams_1","newTime","target","fork","updatedTimings","builder","SubTimelineBuilder","stretchStartingKeyframe","time","slice","_elementTimelineStylesLookup","_previousKeyframe","_currentKeyframe","_keyframes","_styleSummary","_pendingStyles","_backFill","_currentEmptyStepKeyframe","_localTimelineStyles","_globalTimelineStyles","_loadKeyframe","hasPreStyleStep","_updateStyle","getFinalKeyframe","properties","details0","details1","finalKeyframes","keyframe","finalKeyframe","preProps","postProps","kf0","kf1","_stretchStartingKeyframe","newKeyframes","startingGap","newFirstKeyframe","oldFirstKeyframe","oldOffset","timeAtKeyframe","Animation","errorMessage","_animationAst","buildTimelines","destinationStyles","start","dest","AnimationStyleNormalizer","NoopAnimationStyleNormalizer","propertyName","userProvidedProperty","normalizedProperty","WebAnimationsStyleNormalizer","strVal","trim","DIMENSIONAL_PROP_MAP","valAndSuffixMatch","EMPTY_OBJECT","_triggerName","_stateStyles","buildStyles","stateName","backupStateStyler","stateStyler","backupStyles","currentOptions","nextOptions","transitionAnimationParams","currentAnimationParams","currentStateStyles","nextAnimationParams","nextStateStyles","preStyleMap","postStyleMap","isRemoval","animationOptions","queriedElementsList","AnimationStateStyles","defaultParams","combinedParams","styleObj_1","transitionFactories","fallbackTransition","matchTransition","f","matchStyles","EMPTY_INSTRUCTION_MAP","TimelineAnimationEngine","_normalizer","_animations","_playersById","register","id","_buildPlayer","autoStylesMap","inst","destroy","_getPlayer","listen","baseEvent","args","play","pause","reset","restart","finish","init","setPosition","EMPTY_PLAYER_ARRAY","NULL_REMOVAL_STATE","namespaceId","setForRemoval","hasAnimation","removedBeforeQueried","StateValue","isObj","absorbOptions","DEFAULT_STATE_VALUE","DELETED_STATE_VALUE","AnimationTransitionNamespace","hostElement","_engine","_triggers","_queue","_elementListeners","_hostClassName","phase","listeners","triggersWithStates","statesByElement","NG_TRIGGER_CLASSNAME","afterFlush","_getTrigger","trigger","defaultToFallback","TransitionAnimationPlayer","playersOnElement","playersByElement","queued","isFallbackTransition","totalQueuedPlayers","index_1","fromStyles_1","toStyles_1","reportError","deregister","stateMap","clearElementCache","elementPlayers","_destroyInnerNodes","innerNs","namespacesByHostElement","removeNode","doNotRecurse","childElementCount","triggerStates","players_1","markElementAsRemoved","containsPotentialParentTransition","totalAnimations","currentPlayers","playersByQueriedElement","parent_1","triggers","visitedTriggers_1","listener","elementStates","destroyInnerAnimations","_onRemovalComplete","insertNode","parent","drainQueuedTransitions","microtaskId","destroyed","markedForDestroy","sort","d0","d1","elementContainsData","containsData","TransitionAnimationEngine","newHostElements","disabledNodes","_namespaceLookup","_namespaceList","_flushFns","_whenQuietFns","collectedEnterElements","collectedLeaveElements","onRemovalComplete","ns","createNamespace","_balanceNamespaceList","collectEnterElement","found","nextNamespace","registerTrigger","_fetchNamespace","afterFlushAnimationsDone","insertBefore","details","markElementAsDisabled","_buildInstruction","subTimelines","containerElement","whenRenderingDone","Promise","resolve","flush","cleanupFns","_flushAnimations","quietFns_1","skippedPlayers","skippedPlayersMap","queuedInstructions","disabledElementsSet","nodesThatAreDisabled","bodyNode","allEnterNodes","allLeaveNodes","leaveNodesWithoutAnimations","allPlayers","erroneousTransitions","stringMap","setVal_1","setVal","errors_1","error","enterNodesWithoutAnimations","allPreviousPlayersMap","sortedParentElements","unshift","_beforeAnimationBuild","_getPreviousPlayers","prevPlayer","replaceNodes","postStylesMap","preStylesMap","post","pre","rootPlayers","subPlayers","innerPlayer","_buildAnimation","setRealPlayer","parentHasPriority","parent_2","parentPlayers","parentPlayer","playersForElement","queriedPlayerResults","queriedInnerElements","j","queriedPlayers","activePlayers","isQueriedElement","toStateValue","queriedElementPlayers","isRemovalAnimation_1","targetNameSpaceId","targetTriggerName","timelineInstruction","realPlayer","getRealPlayer","beforeDestroy","allQueriedPlayers","allConsumedElements","allSubElements","allNewPlayers","pp","wrappedPlayer","_player","_containsRealPlayer","_queuedCallbacks","_queueEvent","hasStarted","getPosition","AnimationEngine","_triggerCache","_transitionEngine","_timelineEngine","componentId","cacheKey","onInsert","onRemove","disableAnimations","disable","process","property","action","eventPhase","concat","WebAnimationsPlayer","_onDoneFns","_onStartFns","_onDestroyFns","_initialized","_finished","_started","_destroyed","previousStyles","currentSnapshot","_duration","_delay","_onFinish","_preparePlayerBeforeStart","previousStyleProps","startingKeyframe_1","missingStyleProps_1","self_1","domPlayer","_triggerWebAnimation","_finalKeyframe","addEventListener","_resetDomPlayerState","cancel","WebAnimationsDriver","fill","playerOptions","previousWebAnimationPlayers","ɵAnimation","ɵAnimationStyleNormalizer","ɵNoopAnimationStyleNormalizer","ɵWebAnimationsStyleNormalizer","ɵNoopAnimationDriver","ɵAnimationEngine","ɵWebAnimationsDriver","ɵsupportsWebAnimations","ɵWebAnimationsPlayer"],"mappings":"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","file":"/home/travis/build/angular/angular/dist/packages-dist/animations/bundles/animations-browser.umd.min.js","sourcesContent":["/**\n * @license Angular v5.0.0-rc.0-d4d9009\n * (c) 2010-2017 Google, Inc. https://angular.io/\n * License: MIT\n */\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/animations')) :\n\ttypeof define === 'function' && define.amd ? define('@angular/animations/browser', ['exports', '@angular/animations'], factory) :\n\t(factory((global.ng = global.ng || {}, global.ng.animations = global.ng.animations || {}, global.ng.animations.browser = {}),global.ng.animations));\n}(this, (function (exports,_angular_animations) { 'use strict';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n};\n\n/**\n * @license Angular v5.0.0-rc.0-d4d9009\n * (c) 2010-2017 Google, Inc. https://angular.io/\n * License: MIT\n */\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * @param {?} players\n * @return {?}\n */\nfunction optimizeGroupPlayer(players) {\n    switch (players.length) {\n        case 0:\n            return new _angular_animations.NoopAnimationPlayer();\n        case 1:\n            return players[0];\n        default:\n            return new _angular_animations.ɵAnimationGroupPlayer(players);\n    }\n}\n/**\n * @param {?} driver\n * @param {?} normalizer\n * @param {?} element\n * @param {?} keyframes\n * @param {?=} preStyles\n * @param {?=} postStyles\n * @return {?}\n */\nfunction normalizeKeyframes(driver, normalizer, element, keyframes, preStyles, postStyles) {\n    if (preStyles === void 0) { preStyles = {}; }\n    if (postStyles === void 0) { postStyles = {}; }\n    var /** @type {?} */ errors = [];\n    var /** @type {?} */ normalizedKeyframes = [];\n    var /** @type {?} */ previousOffset = -1;\n    var /** @type {?} */ previousKeyframe = null;\n    keyframes.forEach(function (kf) {\n        var /** @type {?} */ offset = /** @type {?} */ (kf['offset']);\n        var /** @type {?} */ isSameOffset = offset == previousOffset;\n        var /** @type {?} */ normalizedKeyframe = (isSameOffset && previousKeyframe) || {};\n        Object.keys(kf).forEach(function (prop) {\n            var /** @type {?} */ normalizedProp = prop;\n            var /** @type {?} */ normalizedValue = kf[prop];\n            if (prop !== 'offset') {\n                normalizedProp = normalizer.normalizePropertyName(normalizedProp, errors);\n                switch (normalizedValue) {\n                    case _angular_animations.ɵPRE_STYLE:\n                        normalizedValue = preStyles[prop];\n                        break;\n                    case _angular_animations.AUTO_STYLE:\n                        normalizedValue = postStyles[prop];\n                        break;\n                    default:\n                        normalizedValue =\n                            normalizer.normalizeStyleValue(prop, normalizedProp, normalizedValue, errors);\n                        break;\n                }\n            }\n            normalizedKeyframe[normalizedProp] = normalizedValue;\n        });\n        if (!isSameOffset) {\n            normalizedKeyframes.push(normalizedKeyframe);\n        }\n        previousKeyframe = normalizedKeyframe;\n        previousOffset = offset;\n    });\n    if (errors.length) {\n        var /** @type {?} */ LINE_START = '\\n - ';\n        throw new Error(\"Unable to animate due to the following errors:\" + LINE_START + errors.join(LINE_START));\n    }\n    return normalizedKeyframes;\n}\n/**\n * @param {?} player\n * @param {?} eventName\n * @param {?} event\n * @param {?} callback\n * @return {?}\n */\nfunction listenOnPlayer(player, eventName, event, callback) {\n    switch (eventName) {\n        case 'start':\n            player.onStart(function () { return callback(event && copyAnimationEvent(event, 'start', player.totalTime)); });\n            break;\n        case 'done':\n            player.onDone(function () { return callback(event && copyAnimationEvent(event, 'done', player.totalTime)); });\n            break;\n        case 'destroy':\n            player.onDestroy(function () { return callback(event && copyAnimationEvent(event, 'destroy', player.totalTime)); });\n            break;\n    }\n}\n/**\n * @param {?} e\n * @param {?=} phaseName\n * @param {?=} totalTime\n * @return {?}\n */\nfunction copyAnimationEvent(e, phaseName, totalTime) {\n    var /** @type {?} */ event = makeAnimationEvent(e.element, e.triggerName, e.fromState, e.toState, phaseName || e.phaseName, totalTime == undefined ? e.totalTime : totalTime);\n    var /** @type {?} */ data = (/** @type {?} */ (e))['_data'];\n    if (data != null) {\n        (/** @type {?} */ (event))['_data'] = data;\n    }\n    return event;\n}\n/**\n * @param {?} element\n * @param {?} triggerName\n * @param {?} fromState\n * @param {?} toState\n * @param {?=} phaseName\n * @param {?=} totalTime\n * @return {?}\n */\nfunction makeAnimationEvent(element, triggerName, fromState, toState, phaseName, totalTime) {\n    if (phaseName === void 0) { phaseName = ''; }\n    if (totalTime === void 0) { totalTime = 0; }\n    return { element: element, triggerName: triggerName, fromState: fromState, toState: toState, phaseName: phaseName, totalTime: totalTime };\n}\n/**\n * @param {?} map\n * @param {?} key\n * @param {?} defaultValue\n * @return {?}\n */\nfunction getOrSetAsInMap(map, key, defaultValue) {\n    var /** @type {?} */ value;\n    if (map instanceof Map) {\n        value = map.get(key);\n        if (!value) {\n            map.set(key, value = defaultValue);\n        }\n    }\n    else {\n        value = map[key];\n        if (!value) {\n            value = map[key] = defaultValue;\n        }\n    }\n    return value;\n}\n/**\n * @param {?} command\n * @return {?}\n */\nfunction parseTimelineCommand(command) {\n    var /** @type {?} */ separatorPos = command.indexOf(':');\n    var /** @type {?} */ id = command.substring(1, separatorPos);\n    var /** @type {?} */ action = command.substr(separatorPos + 1);\n    return [id, action];\n}\nvar _contains = function (elm1, elm2) { return false; };\nvar _matches = function (element, selector) {\n    return false;\n};\nvar _query = function (element, selector, multi) {\n    return [];\n};\nif (typeof Element != 'undefined') {\n    // this is well supported in all browsers\n    _contains = function (elm1, elm2) { return /** @type {?} */ (elm1.contains(elm2)); };\n    if (Element.prototype.matches) {\n        _matches = function (element, selector) { return element.matches(selector); };\n    }\n    else {\n        var /** @type {?} */ proto = /** @type {?} */ (Element.prototype);\n        var /** @type {?} */ fn_1 = proto.matchesSelector || proto.mozMatchesSelector || proto.msMatchesSelector ||\n            proto.oMatchesSelector || proto.webkitMatchesSelector;\n        if (fn_1) {\n            _matches = function (element, selector) { return fn_1.apply(element, [selector]); };\n        }\n    }\n    _query = function (element, selector, multi) {\n        var /** @type {?} */ results = [];\n        if (multi) {\n            results.push.apply(results, element.querySelectorAll(selector));\n        }\n        else {\n            var /** @type {?} */ elm = element.querySelector(selector);\n            if (elm) {\n                results.push(elm);\n            }\n        }\n        return results;\n    };\n}\nvar _CACHED_BODY = null;\n/**\n * @param {?} prop\n * @return {?}\n */\nfunction validateStyleProperty(prop) {\n    if (!_CACHED_BODY) {\n        _CACHED_BODY = getBodyNode() || {};\n    }\n    return /** @type {?} */ ((_CACHED_BODY)).style ? prop in /** @type {?} */ ((_CACHED_BODY)).style : true;\n}\n/**\n * @return {?}\n */\nfunction getBodyNode() {\n    if (typeof document != 'undefined') {\n        return document.body;\n    }\n    return null;\n}\nvar matchesElement = _matches;\nvar containsElement = _contains;\nvar invokeQuery = _query;\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * \\@experimental\n */\nvar NoopAnimationDriver = (function () {\n    function NoopAnimationDriver() {\n    }\n    /**\n     * @param {?} prop\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.validateStyleProperty = /**\n     * @param {?} prop\n     * @return {?}\n     */\n    function (prop) { return validateStyleProperty(prop); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.matchesElement = /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    function (element, selector) {\n        return matchesElement(element, selector);\n    };\n    /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.containsElement = /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    function (elm1, elm2) { return containsElement(elm1, elm2); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.query = /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    function (element, selector, multi) {\n        return invokeQuery(element, selector, multi);\n    };\n    /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.computeStyle = /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    function (element, prop, defaultValue) {\n        return defaultValue || '';\n    };\n    /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.animate = /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @return {?}\n     */\n    function (element, keyframes, duration, delay, easing, previousPlayers) {\n        if (previousPlayers === void 0) { previousPlayers = []; }\n        return new _angular_animations.NoopAnimationPlayer();\n    };\n    return NoopAnimationDriver;\n}());\n/**\n * \\@experimental\n * @abstract\n */\nvar AnimationDriver = (function () {\n    function AnimationDriver() {\n    }\n    AnimationDriver.NOOP = new NoopAnimationDriver();\n    return AnimationDriver;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar ONE_SECOND = 1000;\nvar SUBSTITUTION_EXPR_START = '{{';\nvar SUBSTITUTION_EXPR_END = '}}';\nvar ENTER_CLASSNAME = 'ng-enter';\nvar LEAVE_CLASSNAME = 'ng-leave';\nvar ENTER_SELECTOR = '.ng-enter';\nvar LEAVE_SELECTOR = '.ng-leave';\nvar NG_TRIGGER_CLASSNAME = 'ng-trigger';\nvar NG_TRIGGER_SELECTOR = '.ng-trigger';\nvar NG_ANIMATING_CLASSNAME = 'ng-animating';\nvar NG_ANIMATING_SELECTOR = '.ng-animating';\n/**\n * @param {?} value\n * @return {?}\n */\nfunction resolveTimingValue(value) {\n    if (typeof value == 'number')\n        return value;\n    var /** @type {?} */ matches = (/** @type {?} */ (value)).match(/^(-?[\\.\\d]+)(m?s)/);\n    if (!matches || matches.length < 2)\n        return 0;\n    return _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);\n}\n/**\n * @param {?} value\n * @param {?} unit\n * @return {?}\n */\nfunction _convertTimeValueToMS(value, unit) {\n    switch (unit) {\n        case 's':\n            return value * ONE_SECOND;\n        default:\n            // ms or something else\n            return value;\n    }\n}\n/**\n * @param {?} timings\n * @param {?} errors\n * @param {?=} allowNegativeValues\n * @return {?}\n */\nfunction resolveTiming(timings, errors, allowNegativeValues) {\n    return timings.hasOwnProperty('duration') ? /** @type {?} */ (timings) :\n        parseTimeExpression(/** @type {?} */ (timings), errors, allowNegativeValues);\n}\n/**\n * @param {?} exp\n * @param {?} errors\n * @param {?=} allowNegativeValues\n * @return {?}\n */\nfunction parseTimeExpression(exp, errors, allowNegativeValues) {\n    var /** @type {?} */ regex = /^(-?[\\.\\d]+)(m?s)(?:\\s+(-?[\\.\\d]+)(m?s))?(?:\\s+([-a-z]+(?:\\(.+?\\))?))?$/i;\n    var /** @type {?} */ duration;\n    var /** @type {?} */ delay = 0;\n    var /** @type {?} */ easing = '';\n    if (typeof exp === 'string') {\n        var /** @type {?} */ matches = exp.match(regex);\n        if (matches === null) {\n            errors.push(\"The provided timing value \\\"\" + exp + \"\\\" is invalid.\");\n            return { duration: 0, delay: 0, easing: '' };\n        }\n        duration = _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);\n        var /** @type {?} */ delayMatch = matches[3];\n        if (delayMatch != null) {\n            delay = _convertTimeValueToMS(Math.floor(parseFloat(delayMatch)), matches[4]);\n        }\n        var /** @type {?} */ easingVal = matches[5];\n        if (easingVal) {\n            easing = easingVal;\n        }\n    }\n    else {\n        duration = /** @type {?} */ (exp);\n    }\n    if (!allowNegativeValues) {\n        var /** @type {?} */ containsErrors = false;\n        var /** @type {?} */ startIndex = errors.length;\n        if (duration < 0) {\n            errors.push(\"Duration values below 0 are not allowed for this animation step.\");\n            containsErrors = true;\n        }\n        if (delay < 0) {\n            errors.push(\"Delay values below 0 are not allowed for this animation step.\");\n            containsErrors = true;\n        }\n        if (containsErrors) {\n            errors.splice(startIndex, 0, \"The provided timing value \\\"\" + exp + \"\\\" is invalid.\");\n        }\n    }\n    return { duration: duration, delay: delay, easing: easing };\n}\n/**\n * @param {?} obj\n * @param {?=} destination\n * @return {?}\n */\nfunction copyObj(obj, destination) {\n    if (destination === void 0) { destination = {}; }\n    Object.keys(obj).forEach(function (prop) { destination[prop] = obj[prop]; });\n    return destination;\n}\n/**\n * @param {?} styles\n * @return {?}\n */\nfunction normalizeStyles(styles) {\n    var /** @type {?} */ normalizedStyles = {};\n    if (Array.isArray(styles)) {\n        styles.forEach(function (data) { return copyStyles(data, false, normalizedStyles); });\n    }\n    else {\n        copyStyles(styles, false, normalizedStyles);\n    }\n    return normalizedStyles;\n}\n/**\n * @param {?} styles\n * @param {?} readPrototype\n * @param {?=} destination\n * @return {?}\n */\nfunction copyStyles(styles, readPrototype, destination) {\n    if (destination === void 0) { destination = {}; }\n    if (readPrototype) {\n        // we make use of a for-in loop so that the\n        // prototypically inherited properties are\n        // revealed from the backFill map\n        for (var /** @type {?} */ prop in styles) {\n            destination[prop] = styles[prop];\n        }\n    }\n    else {\n        copyObj(styles, destination);\n    }\n    return destination;\n}\n/**\n * @param {?} element\n * @param {?} styles\n * @return {?}\n */\nfunction setStyles(element, styles) {\n    if (element['style']) {\n        Object.keys(styles).forEach(function (prop) {\n            var /** @type {?} */ camelProp = dashCaseToCamelCase(prop);\n            element.style[camelProp] = styles[prop];\n        });\n    }\n}\n/**\n * @param {?} element\n * @param {?} styles\n * @return {?}\n */\nfunction eraseStyles(element, styles) {\n    if (element['style']) {\n        Object.keys(styles).forEach(function (prop) {\n            var /** @type {?} */ camelProp = dashCaseToCamelCase(prop);\n            element.style[camelProp] = '';\n        });\n    }\n}\n/**\n * @param {?} steps\n * @return {?}\n */\nfunction normalizeAnimationEntry(steps) {\n    if (Array.isArray(steps)) {\n        if (steps.length == 1)\n            return steps[0];\n        return _angular_animations.sequence(steps);\n    }\n    return /** @type {?} */ (steps);\n}\n/**\n * @param {?} value\n * @param {?} options\n * @param {?} errors\n * @return {?}\n */\nfunction validateStyleParams(value, options, errors) {\n    var /** @type {?} */ params = options.params || {};\n    var /** @type {?} */ matches = extractStyleParams(value);\n    if (matches.length) {\n        matches.forEach(function (varName) {\n            if (!params.hasOwnProperty(varName)) {\n                errors.push(\"Unable to resolve the local animation param \" + varName + \" in the given list of values\");\n            }\n        });\n    }\n}\nvar PARAM_REGEX = new RegExp(SUBSTITUTION_EXPR_START + \"\\\\s*(.+?)\\\\s*\" + SUBSTITUTION_EXPR_END, 'g');\n/**\n * @param {?} value\n * @return {?}\n */\nfunction extractStyleParams(value) {\n    var /** @type {?} */ params = [];\n    if (typeof value === 'string') {\n        var /** @type {?} */ val = value.toString();\n        var /** @type {?} */ match = void 0;\n        while (match = PARAM_REGEX.exec(val)) {\n            params.push(/** @type {?} */ (match[1]));\n        }\n        PARAM_REGEX.lastIndex = 0;\n    }\n    return params;\n}\n/**\n * @param {?} value\n * @param {?} params\n * @param {?} errors\n * @return {?}\n */\nfunction interpolateParams(value, params, errors) {\n    var /** @type {?} */ original = value.toString();\n    var /** @type {?} */ str = original.replace(PARAM_REGEX, function (_, varName) {\n        var /** @type {?} */ localVal = params[varName];\n        // this means that the value was never overidden by the data passed in by the user\n        if (!params.hasOwnProperty(varName)) {\n            errors.push(\"Please provide a value for the animation param \" + varName);\n            localVal = '';\n        }\n        return localVal.toString();\n    });\n    // we do this to assert that numeric values stay as they are\n    return str == original ? value : str;\n}\n/**\n * @param {?} iterator\n * @return {?}\n */\nfunction iteratorToArray(iterator) {\n    var /** @type {?} */ arr = [];\n    var /** @type {?} */ item = iterator.next();\n    while (!item.done) {\n        arr.push(item.value);\n        item = iterator.next();\n    }\n    return arr;\n}\n/**\n * @param {?} source\n * @param {?} destination\n * @return {?}\n */\n\nvar DASH_CASE_REGEXP = /-+([a-z0-9])/g;\n/**\n * @param {?} input\n * @return {?}\n */\nfunction dashCaseToCamelCase(input) {\n    return input.replace(DASH_CASE_REGEXP, function () {\n        var m = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            m[_i] = arguments[_i];\n        }\n        return m[1].toUpperCase();\n    });\n}\n/**\n * @param {?} duration\n * @param {?} delay\n * @return {?}\n */\nfunction allowPreviousPlayerStylesMerge(duration, delay) {\n    return duration === 0 || delay === 0;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar EMPTY_ANIMATION_OPTIONS = {};\n/**\n * @record\n */\n\n/**\n * @abstract\n */\nvar Ast = (function () {\n    function Ast() {\n        this.options = EMPTY_ANIMATION_OPTIONS;\n    }\n    Object.defineProperty(Ast.prototype, \"params\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return this.options['params'] || null; },\n        enumerable: true,\n        configurable: true\n    });\n    return Ast;\n}());\nvar TriggerAst = (function (_super) {\n    __extends(TriggerAst, _super);\n    function TriggerAst(name, states, transitions) {\n        var _this = _super.call(this) || this;\n        _this.name = name;\n        _this.states = states;\n        _this.transitions = transitions;\n        _this.queryCount = 0;\n        _this.depCount = 0;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    TriggerAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitTrigger(this, context); };\n    return TriggerAst;\n}(Ast));\nvar StateAst = (function (_super) {\n    __extends(StateAst, _super);\n    function StateAst(name, style$$1) {\n        var _this = _super.call(this) || this;\n        _this.name = name;\n        _this.style = style$$1;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    StateAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitState(this, context); };\n    return StateAst;\n}(Ast));\nvar TransitionAst = (function (_super) {\n    __extends(TransitionAst, _super);\n    function TransitionAst(matchers, animation) {\n        var _this = _super.call(this) || this;\n        _this.matchers = matchers;\n        _this.animation = animation;\n        _this.queryCount = 0;\n        _this.depCount = 0;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    TransitionAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitTransition(this, context); };\n    return TransitionAst;\n}(Ast));\nvar SequenceAst = (function (_super) {\n    __extends(SequenceAst, _super);\n    function SequenceAst(steps) {\n        var _this = _super.call(this) || this;\n        _this.steps = steps;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    SequenceAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitSequence(this, context); };\n    return SequenceAst;\n}(Ast));\nvar GroupAst = (function (_super) {\n    __extends(GroupAst, _super);\n    function GroupAst(steps) {\n        var _this = _super.call(this) || this;\n        _this.steps = steps;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    GroupAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitGroup(this, context); };\n    return GroupAst;\n}(Ast));\nvar AnimateAst = (function (_super) {\n    __extends(AnimateAst, _super);\n    function AnimateAst(timings, style$$1) {\n        var _this = _super.call(this) || this;\n        _this.timings = timings;\n        _this.style = style$$1;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    AnimateAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitAnimate(this, context); };\n    return AnimateAst;\n}(Ast));\nvar StyleAst = (function (_super) {\n    __extends(StyleAst, _super);\n    function StyleAst(styles, easing, offset) {\n        var _this = _super.call(this) || this;\n        _this.styles = styles;\n        _this.easing = easing;\n        _this.offset = offset;\n        _this.isEmptyStep = false;\n        _this.containsDynamicStyles = false;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    StyleAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitStyle(this, context); };\n    return StyleAst;\n}(Ast));\nvar KeyframesAst = (function (_super) {\n    __extends(KeyframesAst, _super);\n    function KeyframesAst(styles) {\n        var _this = _super.call(this) || this;\n        _this.styles = styles;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    KeyframesAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitKeyframes(this, context); };\n    return KeyframesAst;\n}(Ast));\nvar ReferenceAst = (function (_super) {\n    __extends(ReferenceAst, _super);\n    function ReferenceAst(animation) {\n        var _this = _super.call(this) || this;\n        _this.animation = animation;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    ReferenceAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitReference(this, context); };\n    return ReferenceAst;\n}(Ast));\nvar AnimateChildAst = (function (_super) {\n    __extends(AnimateChildAst, _super);\n    function AnimateChildAst() {\n        return _super.call(this) || this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    AnimateChildAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitAnimateChild(this, context); };\n    return AnimateChildAst;\n}(Ast));\nvar AnimateRefAst = (function (_super) {\n    __extends(AnimateRefAst, _super);\n    function AnimateRefAst(animation) {\n        var _this = _super.call(this) || this;\n        _this.animation = animation;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    AnimateRefAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitAnimateRef(this, context); };\n    return AnimateRefAst;\n}(Ast));\nvar QueryAst = (function (_super) {\n    __extends(QueryAst, _super);\n    function QueryAst(selector, limit, optional, includeSelf, animation) {\n        var _this = _super.call(this) || this;\n        _this.selector = selector;\n        _this.limit = limit;\n        _this.optional = optional;\n        _this.includeSelf = includeSelf;\n        _this.animation = animation;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    QueryAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitQuery(this, context); };\n    return QueryAst;\n}(Ast));\nvar StaggerAst = (function (_super) {\n    __extends(StaggerAst, _super);\n    function StaggerAst(timings, animation) {\n        var _this = _super.call(this) || this;\n        _this.timings = timings;\n        _this.animation = animation;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    StaggerAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitStagger(this, context); };\n    return StaggerAst;\n}(Ast));\nvar TimingAst = (function (_super) {\n    __extends(TimingAst, _super);\n    function TimingAst(duration, delay, easing) {\n        if (delay === void 0) { delay = 0; }\n        if (easing === void 0) { easing = null; }\n        var _this = _super.call(this) || this;\n        _this.duration = duration;\n        _this.delay = delay;\n        _this.easing = easing;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    TimingAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitTiming(this, context); };\n    return TimingAst;\n}(Ast));\nvar DynamicTimingAst = (function (_super) {\n    __extends(DynamicTimingAst, _super);\n    function DynamicTimingAst(value) {\n        var _this = _super.call(this, 0, 0, '') || this;\n        _this.value = value;\n        return _this;\n    }\n    /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    DynamicTimingAst.prototype.visit = /**\n     * @param {?} visitor\n     * @param {?} context\n     * @return {?}\n     */\n    function (visitor, context) { return visitor.visitTiming(this, context); };\n    return DynamicTimingAst;\n}(TimingAst));\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @record\n */\n\n/**\n * @param {?} visitor\n * @param {?} node\n * @param {?} context\n * @return {?}\n */\nfunction visitAnimationNode(visitor, node, context) {\n    switch (node.type) {\n        case 7 /* Trigger */:\n            return visitor.visitTrigger(/** @type {?} */ (node), context);\n        case 0 /* State */:\n            return visitor.visitState(/** @type {?} */ (node), context);\n        case 1 /* Transition */:\n            return visitor.visitTransition(/** @type {?} */ (node), context);\n        case 2 /* Sequence */:\n            return visitor.visitSequence(/** @type {?} */ (node), context);\n        case 3 /* Group */:\n            return visitor.visitGroup(/** @type {?} */ (node), context);\n        case 4 /* Animate */:\n            return visitor.visitAnimate(/** @type {?} */ (node), context);\n        case 5 /* Keyframes */:\n            return visitor.visitKeyframes(/** @type {?} */ (node), context);\n        case 6 /* Style */:\n            return visitor.visitStyle(/** @type {?} */ (node), context);\n        case 8 /* Reference */:\n            return visitor.visitReference(/** @type {?} */ (node), context);\n        case 9 /* AnimateChild */:\n            return visitor.visitAnimateChild(/** @type {?} */ (node), context);\n        case 10 /* AnimateRef */:\n            return visitor.visitAnimateRef(/** @type {?} */ (node), context);\n        case 11 /* Query */:\n            return visitor.visitQuery(/** @type {?} */ (node), context);\n        case 12 /* Stagger */:\n            return visitor.visitStagger(/** @type {?} */ (node), context);\n        default:\n            throw new Error(\"Unable to resolve animation metadata node #\" + node.type);\n    }\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar ANY_STATE = '*';\n/**\n * @param {?} transitionValue\n * @param {?} errors\n * @return {?}\n */\nfunction parseTransitionExpr(transitionValue, errors) {\n    var /** @type {?} */ expressions = [];\n    if (typeof transitionValue == 'string') {\n        (/** @type {?} */ (transitionValue))\n            .split(/\\s*,\\s*/)\n            .forEach(function (str) { return parseInnerTransitionStr(str, expressions, errors); });\n    }\n    else {\n        expressions.push(/** @type {?} */ (transitionValue));\n    }\n    return expressions;\n}\n/**\n * @param {?} eventStr\n * @param {?} expressions\n * @param {?} errors\n * @return {?}\n */\nfunction parseInnerTransitionStr(eventStr, expressions, errors) {\n    if (eventStr[0] == ':') {\n        var /** @type {?} */ result = parseAnimationAlias(eventStr, errors);\n        if (typeof result == 'function') {\n            expressions.push(result);\n            return;\n        }\n        eventStr = /** @type {?} */ (result);\n    }\n    var /** @type {?} */ match = eventStr.match(/^(\\*|[-\\w]+)\\s*(<?[=-]>)\\s*(\\*|[-\\w]+)$/);\n    if (match == null || match.length < 4) {\n        errors.push(\"The provided transition expression \\\"\" + eventStr + \"\\\" is not supported\");\n        return expressions;\n    }\n    var /** @type {?} */ fromState = match[1];\n    var /** @type {?} */ separator = match[2];\n    var /** @type {?} */ toState = match[3];\n    expressions.push(makeLambdaFromStates(fromState, toState));\n    var /** @type {?} */ isFullAnyStateExpr = fromState == ANY_STATE && toState == ANY_STATE;\n    if (separator[0] == '<' && !isFullAnyStateExpr) {\n        expressions.push(makeLambdaFromStates(toState, fromState));\n    }\n}\n/**\n * @param {?} alias\n * @param {?} errors\n * @return {?}\n */\nfunction parseAnimationAlias(alias, errors) {\n    switch (alias) {\n        case ':enter':\n            return 'void => *';\n        case ':leave':\n            return '* => void';\n        case ':increment':\n            return function (fromState, toState) { return parseFloat(toState) > parseFloat(fromState); };\n        case ':decrement':\n            return function (fromState, toState) { return parseFloat(toState) < parseFloat(fromState); };\n        default:\n            errors.push(\"The transition alias value \\\"\" + alias + \"\\\" is not supported\");\n            return '* => *';\n    }\n}\n/**\n * @param {?} lhs\n * @param {?} rhs\n * @return {?}\n */\nfunction makeLambdaFromStates(lhs, rhs) {\n    return function (fromState, toState) {\n        var /** @type {?} */ lhsMatch = lhs == ANY_STATE || lhs == fromState;\n        var /** @type {?} */ rhsMatch = rhs == ANY_STATE || rhs == toState;\n        if (!lhsMatch && typeof fromState === 'boolean') {\n            lhsMatch = fromState ? lhs === 'true' : lhs === 'false';\n        }\n        if (!rhsMatch && typeof toState === 'boolean') {\n            rhsMatch = toState ? rhs === 'true' : rhs === 'false';\n        }\n        return lhsMatch && rhsMatch;\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar SELF_TOKEN = ':self';\nvar SELF_TOKEN_REGEX = new RegExp(\"s*\" + SELF_TOKEN + \"s*,?\", 'g');\n/**\n * @param {?} driver\n * @param {?} metadata\n * @param {?} errors\n * @return {?}\n */\nfunction buildAnimationAst(driver, metadata, errors) {\n    return new AnimationAstBuilderVisitor(driver).build(metadata, errors);\n}\nvar LEAVE_TOKEN = ':leave';\nvar LEAVE_TOKEN_REGEX = new RegExp(LEAVE_TOKEN, 'g');\nvar ENTER_TOKEN = ':enter';\nvar ENTER_TOKEN_REGEX = new RegExp(ENTER_TOKEN, 'g');\nvar ROOT_SELECTOR = '';\nvar AnimationAstBuilderVisitor = (function () {\n    function AnimationAstBuilderVisitor(_driver) {\n        this._driver = _driver;\n    }\n    /**\n     * @param {?} metadata\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.build = /**\n     * @param {?} metadata\n     * @param {?} errors\n     * @return {?}\n     */\n    function (metadata, errors) {\n        var /** @type {?} */ context = new AnimationAstBuilderContext(errors);\n        this._resetContextStyleTimingState(context);\n        return /** @type {?} */ (visitAnimationNode(this, normalizeAnimationEntry(metadata), context));\n    };\n    /**\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype._resetContextStyleTimingState = /**\n     * @param {?} context\n     * @return {?}\n     */\n    function (context) {\n        context.currentQuerySelector = ROOT_SELECTOR;\n        context.collectedStyles = {};\n        context.collectedStyles[ROOT_SELECTOR] = {};\n        context.currentTime = 0;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitTrigger = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var _this = this;\n        var /** @type {?} */ queryCount = context.queryCount = 0;\n        var /** @type {?} */ depCount = context.depCount = 0;\n        var /** @type {?} */ states = [];\n        var /** @type {?} */ transitions = [];\n        metadata.definitions.forEach(function (def) {\n            _this._resetContextStyleTimingState(context);\n            if (def.type == 0 /* State */) {\n                var /** @type {?} */ stateDef_1 = /** @type {?} */ (def);\n                var /** @type {?} */ name_1 = stateDef_1.name;\n                name_1.split(/\\s*,\\s*/).forEach(function (n) {\n                    stateDef_1.name = n;\n                    states.push(_this.visitState(stateDef_1, context));\n                });\n                stateDef_1.name = name_1;\n            }\n            else if (def.type == 1 /* Transition */) {\n                var /** @type {?} */ transition = _this.visitTransition(/** @type {?} */ (def), context);\n                queryCount += transition.queryCount;\n                depCount += transition.depCount;\n                transitions.push(transition);\n            }\n            else {\n                context.errors.push('only state() and transition() definitions can sit inside of a trigger()');\n            }\n        });\n        var /** @type {?} */ ast = new TriggerAst(metadata.name, states, transitions);\n        ast.options = normalizeAnimationOptions(metadata.options);\n        ast.queryCount = queryCount;\n        ast.depCount = depCount;\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitState = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ styleAst = this.visitStyle(metadata.styles, context);\n        var /** @type {?} */ astParams = (metadata.options && metadata.options.params) || null;\n        if (styleAst.containsDynamicStyles) {\n            var /** @type {?} */ missingSubs_1 = new Set();\n            var /** @type {?} */ params_1 = astParams || {};\n            styleAst.styles.forEach(function (value) {\n                if (isObject(value)) {\n                    var /** @type {?} */ stylesObj_1 = /** @type {?} */ (value);\n                    Object.keys(stylesObj_1).forEach(function (prop) {\n                        extractStyleParams(stylesObj_1[prop]).forEach(function (sub) {\n                            if (!params_1.hasOwnProperty(sub)) {\n                                missingSubs_1.add(sub);\n                            }\n                        });\n                    });\n                }\n            });\n            if (missingSubs_1.size) {\n                var /** @type {?} */ missingSubsArr = iteratorToArray(missingSubs_1.values());\n                context.errors.push(\"state(\\\"\" + metadata.name + \"\\\", ...) must define default values for all the following style substitutions: \" + missingSubsArr.join(', '));\n            }\n        }\n        var /** @type {?} */ stateAst = new StateAst(metadata.name, styleAst);\n        if (astParams) {\n            stateAst.options = { params: astParams };\n        }\n        return stateAst;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitTransition = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        context.queryCount = 0;\n        context.depCount = 0;\n        var /** @type {?} */ entry = visitAnimationNode(this, normalizeAnimationEntry(metadata.animation), context);\n        var /** @type {?} */ matchers = parseTransitionExpr(metadata.expr, context.errors);\n        var /** @type {?} */ ast = new TransitionAst(matchers, entry);\n        ast.options = normalizeAnimationOptions(metadata.options);\n        ast.queryCount = context.queryCount;\n        ast.depCount = context.depCount;\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitSequence = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var _this = this;\n        var /** @type {?} */ ast = new SequenceAst(metadata.steps.map(function (s) { return visitAnimationNode(_this, s, context); }));\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitGroup = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var _this = this;\n        var /** @type {?} */ currentTime = context.currentTime;\n        var /** @type {?} */ furthestTime = 0;\n        var /** @type {?} */ steps = metadata.steps.map(function (step) {\n            context.currentTime = currentTime;\n            var /** @type {?} */ innerAst = visitAnimationNode(_this, step, context);\n            furthestTime = Math.max(furthestTime, context.currentTime);\n            return innerAst;\n        });\n        context.currentTime = furthestTime;\n        var /** @type {?} */ ast = new GroupAst(steps);\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitAnimate = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ timingAst = constructTimingAst(metadata.timings, context.errors);\n        context.currentAnimateTimings = timingAst;\n        var /** @type {?} */ styles;\n        var /** @type {?} */ styleMetadata = metadata.styles ? metadata.styles : _angular_animations.style({});\n        if (styleMetadata.type == 5 /* Keyframes */) {\n            styles = this.visitKeyframes(/** @type {?} */ (styleMetadata), context);\n        }\n        else {\n            var /** @type {?} */ styleMetadata_1 = /** @type {?} */ (metadata.styles);\n            var /** @type {?} */ isEmpty = false;\n            if (!styleMetadata_1) {\n                isEmpty = true;\n                var /** @type {?} */ newStyleData = {};\n                if (timingAst.easing) {\n                    newStyleData['easing'] = timingAst.easing;\n                }\n                styleMetadata_1 = _angular_animations.style(newStyleData);\n            }\n            context.currentTime += timingAst.duration + timingAst.delay;\n            var /** @type {?} */ styleAst = this.visitStyle(styleMetadata_1, context);\n            styleAst.isEmptyStep = isEmpty;\n            styles = styleAst;\n        }\n        context.currentAnimateTimings = null;\n        return new AnimateAst(timingAst, styles);\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitStyle = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ ast = this._makeStyleAst(metadata, context);\n        this._validateStyleAst(ast, context);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype._makeStyleAst = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ styles = [];\n        if (Array.isArray(metadata.styles)) {\n            (/** @type {?} */ (metadata.styles)).forEach(function (styleTuple) {\n                if (typeof styleTuple == 'string') {\n                    if (styleTuple == _angular_animations.AUTO_STYLE) {\n                        styles.push(/** @type {?} */ (styleTuple));\n                    }\n                    else {\n                        context.errors.push(\"The provided style string value \" + styleTuple + \" is not allowed.\");\n                    }\n                }\n                else {\n                    styles.push(/** @type {?} */ (styleTuple));\n                }\n            });\n        }\n        else {\n            styles.push(metadata.styles);\n        }\n        var /** @type {?} */ containsDynamicStyles = false;\n        var /** @type {?} */ collectedEasing = null;\n        styles.forEach(function (styleData) {\n            if (isObject(styleData)) {\n                var /** @type {?} */ styleMap = /** @type {?} */ (styleData);\n                var /** @type {?} */ easing = styleMap['easing'];\n                if (easing) {\n                    collectedEasing = /** @type {?} */ (easing);\n                    delete styleMap['easing'];\n                }\n                if (!containsDynamicStyles) {\n                    for (var /** @type {?} */ prop in styleMap) {\n                        var /** @type {?} */ value = styleMap[prop];\n                        if (value.toString().indexOf(SUBSTITUTION_EXPR_START) >= 0) {\n                            containsDynamicStyles = true;\n                            break;\n                        }\n                    }\n                }\n            }\n        });\n        var /** @type {?} */ ast = new StyleAst(styles, collectedEasing, metadata.offset);\n        ast.containsDynamicStyles = containsDynamicStyles;\n        return ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype._validateStyleAst = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var _this = this;\n        var /** @type {?} */ timings = context.currentAnimateTimings;\n        var /** @type {?} */ endTime = context.currentTime;\n        var /** @type {?} */ startTime = context.currentTime;\n        if (timings && startTime > 0) {\n            startTime -= timings.duration + timings.delay;\n        }\n        ast.styles.forEach(function (tuple) {\n            if (typeof tuple == 'string')\n                return;\n            Object.keys(tuple).forEach(function (prop) {\n                if (!_this._driver.validateStyleProperty(prop)) {\n                    context.errors.push(\"The provided animation property \\\"\" + prop + \"\\\" is not a supported CSS property for animations\");\n                    return;\n                }\n                var /** @type {?} */ collectedStyles = context.collectedStyles[/** @type {?} */ ((context.currentQuerySelector))];\n                var /** @type {?} */ collectedEntry = collectedStyles[prop];\n                var /** @type {?} */ updateCollectedStyle = true;\n                if (collectedEntry) {\n                    if (startTime != endTime && startTime >= collectedEntry.startTime &&\n                        endTime <= collectedEntry.endTime) {\n                        context.errors.push(\"The CSS property \\\"\" + prop + \"\\\" that exists between the times of \\\"\" + collectedEntry.startTime + \"ms\\\" and \\\"\" + collectedEntry.endTime + \"ms\\\" is also being animated in a parallel animation between the times of \\\"\" + startTime + \"ms\\\" and \\\"\" + endTime + \"ms\\\"\");\n                        updateCollectedStyle = false;\n                    }\n                    // we always choose the smaller start time value since we\n                    // want to have a record of the entire animation window where\n                    // the style property is being animated in between\n                    startTime = collectedEntry.startTime;\n                }\n                if (updateCollectedStyle) {\n                    collectedStyles[prop] = { startTime: startTime, endTime: endTime };\n                }\n                if (context.options) {\n                    validateStyleParams(tuple[prop], context.options, context.errors);\n                }\n            });\n        });\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitKeyframes = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var _this = this;\n        if (!context.currentAnimateTimings) {\n            context.errors.push(\"keyframes() must be placed inside of a call to animate()\");\n            return new KeyframesAst([]);\n        }\n        var /** @type {?} */ MAX_KEYFRAME_OFFSET = 1;\n        var /** @type {?} */ totalKeyframesWithOffsets = 0;\n        var /** @type {?} */ offsets = [];\n        var /** @type {?} */ offsetsOutOfOrder = false;\n        var /** @type {?} */ keyframesOutOfRange = false;\n        var /** @type {?} */ previousOffset = 0;\n        var /** @type {?} */ keyframes = metadata.steps.map(function (styles) {\n            var /** @type {?} */ style$$1 = _this._makeStyleAst(styles, context);\n            var /** @type {?} */ offsetVal = style$$1.offset != null ? style$$1.offset : consumeOffset(style$$1.styles);\n            var /** @type {?} */ offset = 0;\n            if (offsetVal != null) {\n                totalKeyframesWithOffsets++;\n                offset = style$$1.offset = offsetVal;\n            }\n            keyframesOutOfRange = keyframesOutOfRange || offset < 0 || offset > 1;\n            offsetsOutOfOrder = offsetsOutOfOrder || offset < previousOffset;\n            previousOffset = offset;\n            offsets.push(offset);\n            return style$$1;\n        });\n        if (keyframesOutOfRange) {\n            context.errors.push(\"Please ensure that all keyframe offsets are between 0 and 1\");\n        }\n        if (offsetsOutOfOrder) {\n            context.errors.push(\"Please ensure that all keyframe offsets are in order\");\n        }\n        var /** @type {?} */ length = metadata.steps.length;\n        var /** @type {?} */ generatedOffset = 0;\n        if (totalKeyframesWithOffsets > 0 && totalKeyframesWithOffsets < length) {\n            context.errors.push(\"Not all style() steps within the declared keyframes() contain offsets\");\n        }\n        else if (totalKeyframesWithOffsets == 0) {\n            generatedOffset = MAX_KEYFRAME_OFFSET / (length - 1);\n        }\n        var /** @type {?} */ limit = length - 1;\n        var /** @type {?} */ currentTime = context.currentTime;\n        var /** @type {?} */ currentAnimateTimings = /** @type {?} */ ((context.currentAnimateTimings));\n        var /** @type {?} */ animateDuration = currentAnimateTimings.duration;\n        keyframes.forEach(function (kf, i) {\n            var /** @type {?} */ offset = generatedOffset > 0 ? (i == limit ? 1 : (generatedOffset * i)) : offsets[i];\n            var /** @type {?} */ durationUpToThisFrame = offset * animateDuration;\n            context.currentTime = currentTime + currentAnimateTimings.delay + durationUpToThisFrame;\n            currentAnimateTimings.duration = durationUpToThisFrame;\n            _this._validateStyleAst(kf, context);\n            kf.offset = offset;\n        });\n        return new KeyframesAst(keyframes);\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitReference = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ entry = visitAnimationNode(this, normalizeAnimationEntry(metadata.animation), context);\n        var /** @type {?} */ ast = new ReferenceAst(entry);\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitAnimateChild = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        context.depCount++;\n        var /** @type {?} */ ast = new AnimateChildAst();\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitAnimateRef = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ animation = this.visitReference(metadata.animation, context);\n        var /** @type {?} */ ast = new AnimateRefAst(animation);\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitQuery = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ parentSelector = /** @type {?} */ ((context.currentQuerySelector));\n        var /** @type {?} */ options = /** @type {?} */ ((metadata.options || {}));\n        context.queryCount++;\n        context.currentQuery = metadata;\n        var _a = normalizeSelector(metadata.selector), selector = _a[0], includeSelf = _a[1];\n        context.currentQuerySelector =\n            parentSelector.length ? (parentSelector + ' ' + selector) : selector;\n        getOrSetAsInMap(context.collectedStyles, context.currentQuerySelector, {});\n        var /** @type {?} */ entry = visitAnimationNode(this, normalizeAnimationEntry(metadata.animation), context);\n        context.currentQuery = null;\n        context.currentQuerySelector = parentSelector;\n        var /** @type {?} */ ast = new QueryAst(selector, options.limit || 0, !!options.optional, includeSelf, entry);\n        ast.originalSelector = metadata.selector;\n        ast.options = normalizeAnimationOptions(metadata.options);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitStagger = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        if (!context.currentQuery) {\n            context.errors.push(\"stagger() can only be used inside of query()\");\n        }\n        var /** @type {?} */ timings = metadata.timings === 'full' ?\n            { duration: 0, delay: 0, easing: 'full' } :\n            resolveTiming(metadata.timings, context.errors, true);\n        var /** @type {?} */ animation = visitAnimationNode(this, normalizeAnimationEntry(metadata.animation), context);\n        return new StaggerAst(timings, animation);\n    };\n    return AnimationAstBuilderVisitor;\n}());\n/**\n * @param {?} selector\n * @return {?}\n */\nfunction normalizeSelector(selector) {\n    var /** @type {?} */ hasAmpersand = selector.split(/\\s*,\\s*/).find(function (token) { return token == SELF_TOKEN; }) ? true : false;\n    if (hasAmpersand) {\n        selector = selector.replace(SELF_TOKEN_REGEX, '');\n    }\n    selector = selector.replace(ENTER_TOKEN_REGEX, ENTER_SELECTOR)\n        .replace(LEAVE_TOKEN_REGEX, LEAVE_SELECTOR)\n        .replace(/@\\*/g, NG_TRIGGER_SELECTOR)\n        .replace(/@\\w+/g, function (match) { return NG_TRIGGER_SELECTOR + '-' + match.substr(1); })\n        .replace(/:animating/g, NG_ANIMATING_SELECTOR);\n    return [selector, hasAmpersand];\n}\n/**\n * @param {?} obj\n * @return {?}\n */\nfunction normalizeParams(obj) {\n    return obj ? copyObj(obj) : null;\n}\nvar AnimationAstBuilderContext = (function () {\n    function AnimationAstBuilderContext(errors) {\n        this.errors = errors;\n        this.queryCount = 0;\n        this.depCount = 0;\n        this.currentTransition = null;\n        this.currentQuery = null;\n        this.currentQuerySelector = null;\n        this.currentAnimateTimings = null;\n        this.currentTime = 0;\n        this.collectedStyles = {};\n        this.options = null;\n    }\n    return AnimationAstBuilderContext;\n}());\n/**\n * @param {?} styles\n * @return {?}\n */\nfunction consumeOffset(styles) {\n    if (typeof styles == 'string')\n        return null;\n    var /** @type {?} */ offset = null;\n    if (Array.isArray(styles)) {\n        styles.forEach(function (styleTuple) {\n            if (isObject(styleTuple) && styleTuple.hasOwnProperty('offset')) {\n                var /** @type {?} */ obj = /** @type {?} */ (styleTuple);\n                offset = parseFloat(/** @type {?} */ (obj['offset']));\n                delete obj['offset'];\n            }\n        });\n    }\n    else if (isObject(styles) && styles.hasOwnProperty('offset')) {\n        var /** @type {?} */ obj = /** @type {?} */ (styles);\n        offset = parseFloat(/** @type {?} */ (obj['offset']));\n        delete obj['offset'];\n    }\n    return offset;\n}\n/**\n * @param {?} value\n * @return {?}\n */\nfunction isObject(value) {\n    return !Array.isArray(value) && typeof value == 'object';\n}\n/**\n * @param {?} value\n * @param {?} errors\n * @return {?}\n */\nfunction constructTimingAst(value, errors) {\n    var /** @type {?} */ timings = null;\n    if (value.hasOwnProperty('duration')) {\n        timings = /** @type {?} */ (value);\n    }\n    else if (typeof value == 'number') {\n        var /** @type {?} */ duration = resolveTiming(/** @type {?} */ (value), errors).duration;\n        return new TimingAst(/** @type {?} */ (value), 0, '');\n    }\n    var /** @type {?} */ strValue = /** @type {?} */ (value);\n    var /** @type {?} */ isDynamic = strValue.split(/\\s+/).some(function (v) { return v.charAt(0) == '{' && v.charAt(1) == '{'; });\n    if (isDynamic) {\n        return new DynamicTimingAst(strValue);\n    }\n    timings = timings || resolveTiming(strValue, errors);\n    return new TimingAst(timings.duration, timings.delay, timings.easing);\n}\n/**\n * @param {?} options\n * @return {?}\n */\nfunction normalizeAnimationOptions(options) {\n    if (options) {\n        options = copyObj(options);\n        if (options['params']) {\n            options['params'] = /** @type {?} */ ((normalizeParams(options['params'])));\n        }\n    }\n    else {\n        options = {};\n    }\n    return options;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @record\n */\n\n/**\n * @param {?} element\n * @param {?} keyframes\n * @param {?} preStyleProps\n * @param {?} postStyleProps\n * @param {?} duration\n * @param {?} delay\n * @param {?=} easing\n * @param {?=} subTimeline\n * @return {?}\n */\nfunction createTimelineInstruction(element, keyframes, preStyleProps, postStyleProps, duration, delay, easing, subTimeline) {\n    if (easing === void 0) { easing = null; }\n    if (subTimeline === void 0) { subTimeline = false; }\n    return {\n        type: 1 /* TimelineAnimation */,\n        element: element,\n        keyframes: keyframes,\n        preStyleProps: preStyleProps,\n        postStyleProps: postStyleProps,\n        duration: duration,\n        delay: delay,\n        totalTime: duration + delay, easing: easing, subTimeline: subTimeline\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar ElementInstructionMap = (function () {\n    function ElementInstructionMap() {\n        this._map = new Map();\n    }\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.consume = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        var /** @type {?} */ instructions = this._map.get(element);\n        if (instructions) {\n            this._map.delete(element);\n        }\n        else {\n            instructions = [];\n        }\n        return instructions;\n    };\n    /**\n     * @param {?} element\n     * @param {?} instructions\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.append = /**\n     * @param {?} element\n     * @param {?} instructions\n     * @return {?}\n     */\n    function (element, instructions) {\n        var /** @type {?} */ existingInstructions = this._map.get(element);\n        if (!existingInstructions) {\n            this._map.set(element, existingInstructions = []);\n        }\n        existingInstructions.push.apply(existingInstructions, instructions);\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.has = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) { return this._map.has(element); };\n    /**\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.clear = /**\n     * @return {?}\n     */\n    function () { this._map.clear(); };\n    return ElementInstructionMap;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar ONE_FRAME_IN_MILLISECONDS = 1;\n/**\n * @param {?} driver\n * @param {?} rootElement\n * @param {?} ast\n * @param {?=} startingStyles\n * @param {?=} finalStyles\n * @param {?=} options\n * @param {?=} subInstructions\n * @param {?=} errors\n * @return {?}\n */\nfunction buildAnimationTimelines(driver, rootElement, ast, startingStyles, finalStyles, options, subInstructions, errors) {\n    if (startingStyles === void 0) { startingStyles = {}; }\n    if (finalStyles === void 0) { finalStyles = {}; }\n    if (errors === void 0) { errors = []; }\n    return new AnimationTimelineBuilderVisitor().buildKeyframes(driver, rootElement, ast, startingStyles, finalStyles, options, subInstructions, errors);\n}\nvar AnimationTimelineBuilderVisitor = (function () {\n    function AnimationTimelineBuilderVisitor() {\n    }\n    /**\n     * @param {?} driver\n     * @param {?} rootElement\n     * @param {?} ast\n     * @param {?} startingStyles\n     * @param {?} finalStyles\n     * @param {?} options\n     * @param {?=} subInstructions\n     * @param {?=} errors\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.buildKeyframes = /**\n     * @param {?} driver\n     * @param {?} rootElement\n     * @param {?} ast\n     * @param {?} startingStyles\n     * @param {?} finalStyles\n     * @param {?} options\n     * @param {?=} subInstructions\n     * @param {?=} errors\n     * @return {?}\n     */\n    function (driver, rootElement, ast, startingStyles, finalStyles, options, subInstructions, errors) {\n        if (errors === void 0) { errors = []; }\n        subInstructions = subInstructions || new ElementInstructionMap();\n        var /** @type {?} */ context = new AnimationTimelineContext(driver, rootElement, subInstructions, errors, []);\n        context.options = options;\n        context.currentTimeline.setStyles([startingStyles], null, context.errors, options);\n        ast.visit(this, context);\n        // this checks to see if an actual animation happened\n        var /** @type {?} */ timelines = context.timelines.filter(function (timeline) { return timeline.containsAnimation(); });\n        if (timelines.length && Object.keys(finalStyles).length) {\n            var /** @type {?} */ tl = timelines[timelines.length - 1];\n            if (!tl.allowOnlyTimelineStyles()) {\n                tl.setStyles([finalStyles], null, context.errors, options);\n            }\n        }\n        return timelines.length ? timelines.map(function (timeline) { return timeline.buildKeyframes(); }) :\n            [createTimelineInstruction(rootElement, [], [], [], 0, 0, '', false)];\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitTrigger = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        // these values are not visited in this AST\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitState = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        // these values are not visited in this AST\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitTransition = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        // these values are not visited in this AST\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitAnimateChild = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ elementInstructions = context.subInstructions.consume(context.element);\n        if (elementInstructions) {\n            var /** @type {?} */ innerContext = context.createSubContext(ast.options);\n            var /** @type {?} */ startTime = context.currentTimeline.currentTime;\n            var /** @type {?} */ endTime = this._visitSubInstructions(elementInstructions, innerContext, /** @type {?} */ (innerContext.options));\n            if (startTime != endTime) {\n                // we do this on the upper context because we created a sub context for\n                // the sub child animations\n                context.transformIntoNewTimeline(endTime);\n            }\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitAnimateRef = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ innerContext = context.createSubContext(ast.options);\n        innerContext.transformIntoNewTimeline();\n        this.visitReference(ast.animation, innerContext);\n        context.transformIntoNewTimeline(innerContext.currentTimeline.currentTime);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} instructions\n     * @param {?} context\n     * @param {?} options\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype._visitSubInstructions = /**\n     * @param {?} instructions\n     * @param {?} context\n     * @param {?} options\n     * @return {?}\n     */\n    function (instructions, context, options) {\n        var /** @type {?} */ startTime = context.currentTimeline.currentTime;\n        var /** @type {?} */ furthestTime = startTime;\n        // this is a special-case for when a user wants to skip a sub\n        // animation from being fired entirely.\n        var /** @type {?} */ duration = options.duration != null ? resolveTimingValue(options.duration) : null;\n        var /** @type {?} */ delay = options.delay != null ? resolveTimingValue(options.delay) : null;\n        if (duration !== 0) {\n            instructions.forEach(function (instruction) {\n                var /** @type {?} */ instructionTimings = context.appendInstructionToTimeline(instruction, duration, delay);\n                furthestTime =\n                    Math.max(furthestTime, instructionTimings.duration + instructionTimings.delay);\n            });\n        }\n        return furthestTime;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitReference = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        context.updateOptions(ast.options, true);\n        ast.animation.visit(this, context);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitSequence = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var _this = this;\n        var /** @type {?} */ subContextCount = context.subContextCount;\n        var /** @type {?} */ ctx = context;\n        var /** @type {?} */ options = ast.options;\n        if (options && (options.params || options.delay)) {\n            ctx = context.createSubContext(options);\n            ctx.transformIntoNewTimeline();\n            if (options.delay != null) {\n                if (ctx.previousNode instanceof StyleAst) {\n                    ctx.currentTimeline.snapshotCurrentStyles();\n                    ctx.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n                }\n                var /** @type {?} */ delay = resolveTimingValue(options.delay);\n                ctx.delayNextStep(delay);\n            }\n        }\n        if (ast.steps.length) {\n            ast.steps.forEach(function (s) { return s.visit(_this, ctx); });\n            // this is here just incase the inner steps only contain or end with a style() call\n            ctx.currentTimeline.applyStylesToKeyframe();\n            // this means that some animation function within the sequence\n            // ended up creating a sub timeline (which means the current\n            // timeline cannot overlap with the contents of the sequence)\n            if (ctx.subContextCount > subContextCount) {\n                ctx.transformIntoNewTimeline();\n            }\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitGroup = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var _this = this;\n        var /** @type {?} */ innerTimelines = [];\n        var /** @type {?} */ furthestTime = context.currentTimeline.currentTime;\n        var /** @type {?} */ delay = ast.options && ast.options.delay ? resolveTimingValue(ast.options.delay) : 0;\n        ast.steps.forEach(function (s) {\n            var /** @type {?} */ innerContext = context.createSubContext(ast.options);\n            if (delay) {\n                innerContext.delayNextStep(delay);\n            }\n            s.visit(_this, innerContext);\n            furthestTime = Math.max(furthestTime, innerContext.currentTimeline.currentTime);\n            innerTimelines.push(innerContext.currentTimeline);\n        });\n        // this operation is run after the AST loop because otherwise\n        // if the parent timeline's collected styles were updated then\n        // it would pass in invalid data into the new-to-be forked items\n        innerTimelines.forEach(function (timeline) { return context.currentTimeline.mergeTimelineCollectedStyles(timeline); });\n        context.transformIntoNewTimeline(furthestTime);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitTiming = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        if (ast instanceof DynamicTimingAst) {\n            var /** @type {?} */ strValue = context.params ?\n                interpolateParams(ast.value, context.params, context.errors) :\n                ast.value.toString();\n            return resolveTiming(strValue, context.errors);\n        }\n        else {\n            return { duration: ast.duration, delay: ast.delay, easing: ast.easing };\n        }\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitAnimate = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ timings = context.currentAnimateTimings = this.visitTiming(ast.timings, context);\n        var /** @type {?} */ timeline = context.currentTimeline;\n        if (timings.delay) {\n            context.incrementTime(timings.delay);\n            timeline.snapshotCurrentStyles();\n        }\n        var /** @type {?} */ style$$1 = ast.style;\n        if (style$$1 instanceof KeyframesAst) {\n            this.visitKeyframes(style$$1, context);\n        }\n        else {\n            context.incrementTime(timings.duration);\n            this.visitStyle(/** @type {?} */ (style$$1), context);\n            timeline.applyStylesToKeyframe();\n        }\n        context.currentAnimateTimings = null;\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitStyle = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ timeline = context.currentTimeline;\n        var /** @type {?} */ timings = /** @type {?} */ ((context.currentAnimateTimings));\n        // this is a special case for when a style() call\n        // directly follows  an animate() call (but not inside of an animate() call)\n        if (!timings && timeline.getCurrentStyleProperties().length) {\n            timeline.forwardFrame();\n        }\n        var /** @type {?} */ easing = (timings && timings.easing) || ast.easing;\n        if (ast.isEmptyStep) {\n            timeline.applyEmptyStep(easing);\n        }\n        else {\n            timeline.setStyles(ast.styles, easing, context.errors, context.options);\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitKeyframes = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ currentAnimateTimings = /** @type {?} */ ((context.currentAnimateTimings));\n        var /** @type {?} */ startTime = (/** @type {?} */ ((context.currentTimeline))).duration;\n        var /** @type {?} */ duration = currentAnimateTimings.duration;\n        var /** @type {?} */ innerContext = context.createSubContext();\n        var /** @type {?} */ innerTimeline = innerContext.currentTimeline;\n        innerTimeline.easing = currentAnimateTimings.easing;\n        ast.styles.forEach(function (step) {\n            var /** @type {?} */ offset = step.offset || 0;\n            innerTimeline.forwardTime(offset * duration);\n            innerTimeline.setStyles(step.styles, step.easing, context.errors, context.options);\n            innerTimeline.applyStylesToKeyframe();\n        });\n        // this will ensure that the parent timeline gets all the styles from\n        // the child even if the new timeline below is not used\n        context.currentTimeline.mergeTimelineCollectedStyles(innerTimeline);\n        // we do this because the window between this timeline and the sub timeline\n        // should ensure that the styles within are exactly the same as they were before\n        context.transformIntoNewTimeline(startTime + duration);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitQuery = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var _this = this;\n        // in the event that the first step before this is a style step we need\n        // to ensure the styles are applied before the children are animated\n        var /** @type {?} */ startTime = context.currentTimeline.currentTime;\n        var /** @type {?} */ options = /** @type {?} */ ((ast.options || {}));\n        var /** @type {?} */ delay = options.delay ? resolveTimingValue(options.delay) : 0;\n        if (delay && (context.previousNode instanceof StyleAst ||\n            (startTime == 0 && context.currentTimeline.getCurrentStyleProperties().length))) {\n            context.currentTimeline.snapshotCurrentStyles();\n            context.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n        }\n        var /** @type {?} */ furthestTime = startTime;\n        var /** @type {?} */ elms = context.invokeQuery(ast.selector, ast.originalSelector, ast.limit, ast.includeSelf, options.optional ? true : false, context.errors);\n        context.currentQueryTotal = elms.length;\n        var /** @type {?} */ sameElementTimeline = null;\n        elms.forEach(function (element, i) {\n            context.currentQueryIndex = i;\n            var /** @type {?} */ innerContext = context.createSubContext(ast.options, element);\n            if (delay) {\n                innerContext.delayNextStep(delay);\n            }\n            if (element === context.element) {\n                sameElementTimeline = innerContext.currentTimeline;\n            }\n            ast.animation.visit(_this, innerContext);\n            // this is here just incase the inner steps only contain or end\n            // with a style() call (which is here to signal that this is a preparatory\n            // call to style an element before it is animated again)\n            innerContext.currentTimeline.applyStylesToKeyframe();\n            var /** @type {?} */ endTime = innerContext.currentTimeline.currentTime;\n            furthestTime = Math.max(furthestTime, endTime);\n        });\n        context.currentQueryIndex = 0;\n        context.currentQueryTotal = 0;\n        context.transformIntoNewTimeline(furthestTime);\n        if (sameElementTimeline) {\n            context.currentTimeline.mergeTimelineCollectedStyles(sameElementTimeline);\n            context.currentTimeline.snapshotCurrentStyles();\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitStagger = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ parentContext = /** @type {?} */ ((context.parentContext));\n        var /** @type {?} */ tl = context.currentTimeline;\n        var /** @type {?} */ timings = ast.timings;\n        var /** @type {?} */ duration = Math.abs(timings.duration);\n        var /** @type {?} */ maxTime = duration * (context.currentQueryTotal - 1);\n        var /** @type {?} */ delay = duration * context.currentQueryIndex;\n        var /** @type {?} */ staggerTransformer = timings.duration < 0 ? 'reverse' : timings.easing;\n        switch (staggerTransformer) {\n            case 'reverse':\n                delay = maxTime - delay;\n                break;\n            case 'full':\n                delay = parentContext.currentStaggerTime;\n                break;\n        }\n        var /** @type {?} */ timeline = context.currentTimeline;\n        if (delay) {\n            timeline.delayNextStep(delay);\n        }\n        var /** @type {?} */ startingTime = timeline.currentTime;\n        ast.animation.visit(this, context);\n        context.previousNode = ast;\n        // time = duration + delay\n        // the reason why this computation is so complex is because\n        // the inner timeline may either have a delay value or a stretched\n        // keyframe depending on if a subtimeline is not used or is used.\n        parentContext.currentStaggerTime =\n            (tl.currentTime - startingTime) + (tl.startTime - parentContext.currentTimeline.startTime);\n    };\n    return AnimationTimelineBuilderVisitor;\n}());\nvar DEFAULT_NOOP_PREVIOUS_NODE = /** @type {?} */ ({});\nvar AnimationTimelineContext = (function () {\n    function AnimationTimelineContext(_driver, element, subInstructions, errors, timelines, initialTimeline) {\n        this._driver = _driver;\n        this.element = element;\n        this.subInstructions = subInstructions;\n        this.errors = errors;\n        this.timelines = timelines;\n        this.parentContext = null;\n        this.currentAnimateTimings = null;\n        this.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n        this.subContextCount = 0;\n        this.options = {};\n        this.currentQueryIndex = 0;\n        this.currentQueryTotal = 0;\n        this.currentStaggerTime = 0;\n        this.currentTimeline = initialTimeline || new TimelineBuilder(this._driver, element, 0);\n        timelines.push(this.currentTimeline);\n    }\n    Object.defineProperty(AnimationTimelineContext.prototype, \"params\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return this.options.params; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} options\n     * @param {?=} skipIfExists\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.updateOptions = /**\n     * @param {?} options\n     * @param {?=} skipIfExists\n     * @return {?}\n     */\n    function (options, skipIfExists) {\n        var _this = this;\n        if (!options)\n            return;\n        var /** @type {?} */ newOptions = /** @type {?} */ (options);\n        var /** @type {?} */ optionsToUpdate = this.options;\n        // NOTE: this will get patched up when other animation methods support duration overrides\n        if (newOptions.duration != null) {\n            (/** @type {?} */ (optionsToUpdate)).duration = resolveTimingValue(newOptions.duration);\n        }\n        if (newOptions.delay != null) {\n            optionsToUpdate.delay = resolveTimingValue(newOptions.delay);\n        }\n        var /** @type {?} */ newParams = newOptions.params;\n        if (newParams) {\n            var /** @type {?} */ paramsToUpdate_1 = /** @type {?} */ ((optionsToUpdate.params));\n            if (!paramsToUpdate_1) {\n                paramsToUpdate_1 = this.options.params = {};\n            }\n            Object.keys(newParams).forEach(function (name) {\n                if (!skipIfExists || !paramsToUpdate_1.hasOwnProperty(name)) {\n                    paramsToUpdate_1[name] = interpolateParams(newParams[name], paramsToUpdate_1, _this.errors);\n                }\n            });\n        }\n    };\n    /**\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype._copyOptions = /**\n     * @return {?}\n     */\n    function () {\n        var /** @type {?} */ options = {};\n        if (this.options) {\n            var /** @type {?} */ oldParams_1 = this.options.params;\n            if (oldParams_1) {\n                var /** @type {?} */ params_1 = options['params'] = {};\n                Object.keys(this.options.params).forEach(function (name) { params_1[name] = oldParams_1[name]; });\n            }\n        }\n        return options;\n    };\n    /**\n     * @param {?=} options\n     * @param {?=} element\n     * @param {?=} newTime\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.createSubContext = /**\n     * @param {?=} options\n     * @param {?=} element\n     * @param {?=} newTime\n     * @return {?}\n     */\n    function (options, element, newTime) {\n        if (options === void 0) { options = null; }\n        var /** @type {?} */ target = element || this.element;\n        var /** @type {?} */ context = new AnimationTimelineContext(this._driver, target, this.subInstructions, this.errors, this.timelines, this.currentTimeline.fork(target, newTime || 0));\n        context.previousNode = this.previousNode;\n        context.currentAnimateTimings = this.currentAnimateTimings;\n        context.options = this._copyOptions();\n        context.updateOptions(options);\n        context.currentQueryIndex = this.currentQueryIndex;\n        context.currentQueryTotal = this.currentQueryTotal;\n        context.parentContext = this;\n        this.subContextCount++;\n        return context;\n    };\n    /**\n     * @param {?=} newTime\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.transformIntoNewTimeline = /**\n     * @param {?=} newTime\n     * @return {?}\n     */\n    function (newTime) {\n        this.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n        this.currentTimeline = this.currentTimeline.fork(this.element, newTime);\n        this.timelines.push(this.currentTimeline);\n        return this.currentTimeline;\n    };\n    /**\n     * @param {?} instruction\n     * @param {?} duration\n     * @param {?} delay\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.appendInstructionToTimeline = /**\n     * @param {?} instruction\n     * @param {?} duration\n     * @param {?} delay\n     * @return {?}\n     */\n    function (instruction, duration, delay) {\n        var /** @type {?} */ updatedTimings = {\n            duration: duration != null ? duration : instruction.duration,\n            delay: this.currentTimeline.currentTime + (delay != null ? delay : 0) + instruction.delay,\n            easing: ''\n        };\n        var /** @type {?} */ builder = new SubTimelineBuilder(this._driver, instruction.element, instruction.keyframes, instruction.preStyleProps, instruction.postStyleProps, updatedTimings, instruction.stretchStartingKeyframe);\n        this.timelines.push(builder);\n        return updatedTimings;\n    };\n    /**\n     * @param {?} time\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.incrementTime = /**\n     * @param {?} time\n     * @return {?}\n     */\n    function (time) {\n        this.currentTimeline.forwardTime(this.currentTimeline.duration + time);\n    };\n    /**\n     * @param {?} delay\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.delayNextStep = /**\n     * @param {?} delay\n     * @return {?}\n     */\n    function (delay) {\n        // negative delays are not yet supported\n        if (delay > 0) {\n            this.currentTimeline.delayNextStep(delay);\n        }\n    };\n    /**\n     * @param {?} selector\n     * @param {?} originalSelector\n     * @param {?} limit\n     * @param {?} includeSelf\n     * @param {?} optional\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.invokeQuery = /**\n     * @param {?} selector\n     * @param {?} originalSelector\n     * @param {?} limit\n     * @param {?} includeSelf\n     * @param {?} optional\n     * @param {?} errors\n     * @return {?}\n     */\n    function (selector, originalSelector, limit, includeSelf, optional, errors) {\n        var /** @type {?} */ results = [];\n        if (includeSelf) {\n            results.push(this.element);\n        }\n        if (selector.length > 0) {\n            // if :self is only used then the selector is empty\n            var /** @type {?} */ multi = limit != 1;\n            var /** @type {?} */ elements = this._driver.query(this.element, selector, multi);\n            if (limit !== 0) {\n                elements = limit < 0 ? elements.slice(elements.length + limit, elements.length) :\n                    elements.slice(0, limit);\n            }\n            results.push.apply(results, elements);\n        }\n        if (!optional && results.length == 0) {\n            errors.push(\"`query(\\\"\" + originalSelector + \"\\\")` returned zero elements. (Use `query(\\\"\" + originalSelector + \"\\\", { optional: true })` if you wish to allow this.)\");\n        }\n        return results;\n    };\n    return AnimationTimelineContext;\n}());\nvar TimelineBuilder = (function () {\n    function TimelineBuilder(_driver, element, startTime, _elementTimelineStylesLookup) {\n        this._driver = _driver;\n        this.element = element;\n        this.startTime = startTime;\n        this._elementTimelineStylesLookup = _elementTimelineStylesLookup;\n        this.duration = 0;\n        this._previousKeyframe = {};\n        this._currentKeyframe = {};\n        this._keyframes = new Map();\n        this._styleSummary = {};\n        this._pendingStyles = {};\n        this._backFill = {};\n        this._currentEmptyStepKeyframe = null;\n        if (!this._elementTimelineStylesLookup) {\n            this._elementTimelineStylesLookup = new Map();\n        }\n        this._localTimelineStyles = Object.create(this._backFill, {});\n        this._globalTimelineStyles = /** @type {?} */ ((this._elementTimelineStylesLookup.get(element)));\n        if (!this._globalTimelineStyles) {\n            this._globalTimelineStyles = this._localTimelineStyles;\n            this._elementTimelineStylesLookup.set(element, this._localTimelineStyles);\n        }\n        this._loadKeyframe();\n    }\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.containsAnimation = /**\n     * @return {?}\n     */\n    function () {\n        switch (this._keyframes.size) {\n            case 0:\n                return false;\n            case 1:\n                return this.getCurrentStyleProperties().length > 0;\n            default:\n                return true;\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.getCurrentStyleProperties = /**\n     * @return {?}\n     */\n    function () { return Object.keys(this._currentKeyframe); };\n    Object.defineProperty(TimelineBuilder.prototype, \"currentTime\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return this.startTime + this.duration; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} delay\n     * @return {?}\n     */\n    TimelineBuilder.prototype.delayNextStep = /**\n     * @param {?} delay\n     * @return {?}\n     */\n    function (delay) {\n        // in the event that a style() step is placed right before a stagger()\n        // and that style() step is the very first style() value in the animation\n        // then we need to make a copy of the keyframe [0, copy, 1] so that the delay\n        // properly applies the style() values to work with the stagger...\n        var /** @type {?} */ hasPreStyleStep = this._keyframes.size == 1 && Object.keys(this._pendingStyles).length;\n        if (this.duration || hasPreStyleStep) {\n            this.forwardTime(this.currentTime + delay);\n            if (hasPreStyleStep) {\n                this.snapshotCurrentStyles();\n            }\n        }\n        else {\n            this.startTime += delay;\n        }\n    };\n    /**\n     * @param {?} element\n     * @param {?=} currentTime\n     * @return {?}\n     */\n    TimelineBuilder.prototype.fork = /**\n     * @param {?} element\n     * @param {?=} currentTime\n     * @return {?}\n     */\n    function (element, currentTime) {\n        this.applyStylesToKeyframe();\n        return new TimelineBuilder(this._driver, element, currentTime || this.currentTime, this._elementTimelineStylesLookup);\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype._loadKeyframe = /**\n     * @return {?}\n     */\n    function () {\n        if (this._currentKeyframe) {\n            this._previousKeyframe = this._currentKeyframe;\n        }\n        this._currentKeyframe = /** @type {?} */ ((this._keyframes.get(this.duration)));\n        if (!this._currentKeyframe) {\n            this._currentKeyframe = Object.create(this._backFill, {});\n            this._keyframes.set(this.duration, this._currentKeyframe);\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.forwardFrame = /**\n     * @return {?}\n     */\n    function () {\n        this.duration += ONE_FRAME_IN_MILLISECONDS;\n        this._loadKeyframe();\n    };\n    /**\n     * @param {?} time\n     * @return {?}\n     */\n    TimelineBuilder.prototype.forwardTime = /**\n     * @param {?} time\n     * @return {?}\n     */\n    function (time) {\n        this.applyStylesToKeyframe();\n        this.duration = time;\n        this._loadKeyframe();\n    };\n    /**\n     * @param {?} prop\n     * @param {?} value\n     * @return {?}\n     */\n    TimelineBuilder.prototype._updateStyle = /**\n     * @param {?} prop\n     * @param {?} value\n     * @return {?}\n     */\n    function (prop, value) {\n        this._localTimelineStyles[prop] = value;\n        this._globalTimelineStyles[prop] = value;\n        this._styleSummary[prop] = { time: this.currentTime, value: value };\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.allowOnlyTimelineStyles = /**\n     * @return {?}\n     */\n    function () { return this._currentEmptyStepKeyframe !== this._currentKeyframe; };\n    /**\n     * @param {?} easing\n     * @return {?}\n     */\n    TimelineBuilder.prototype.applyEmptyStep = /**\n     * @param {?} easing\n     * @return {?}\n     */\n    function (easing) {\n        var _this = this;\n        if (easing) {\n            this._previousKeyframe['easing'] = easing;\n        }\n        // special case for animate(duration):\n        // all missing styles are filled with a `*` value then\n        // if any destination styles are filled in later on the same\n        // keyframe then they will override the overridden styles\n        // We use `_globalTimelineStyles` here because there may be\n        // styles in previous keyframes that are not present in this timeline\n        Object.keys(this._globalTimelineStyles).forEach(function (prop) {\n            _this._backFill[prop] = _this._globalTimelineStyles[prop] || _angular_animations.AUTO_STYLE;\n            _this._currentKeyframe[prop] = _angular_animations.AUTO_STYLE;\n        });\n        this._currentEmptyStepKeyframe = this._currentKeyframe;\n    };\n    /**\n     * @param {?} input\n     * @param {?} easing\n     * @param {?} errors\n     * @param {?=} options\n     * @return {?}\n     */\n    TimelineBuilder.prototype.setStyles = /**\n     * @param {?} input\n     * @param {?} easing\n     * @param {?} errors\n     * @param {?=} options\n     * @return {?}\n     */\n    function (input, easing, errors, options) {\n        var _this = this;\n        if (easing) {\n            this._previousKeyframe['easing'] = easing;\n        }\n        var /** @type {?} */ params = (options && options.params) || {};\n        var /** @type {?} */ styles = flattenStyles(input, this._globalTimelineStyles);\n        Object.keys(styles).forEach(function (prop) {\n            var /** @type {?} */ val = interpolateParams(styles[prop], params, errors);\n            _this._pendingStyles[prop] = val;\n            if (!_this._localTimelineStyles.hasOwnProperty(prop)) {\n                _this._backFill[prop] = _this._globalTimelineStyles.hasOwnProperty(prop) ?\n                    _this._globalTimelineStyles[prop] :\n                    _angular_animations.AUTO_STYLE;\n            }\n            _this._updateStyle(prop, val);\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.applyStylesToKeyframe = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        var /** @type {?} */ styles = this._pendingStyles;\n        var /** @type {?} */ props = Object.keys(styles);\n        if (props.length == 0)\n            return;\n        this._pendingStyles = {};\n        props.forEach(function (prop) {\n            var /** @type {?} */ val = styles[prop];\n            _this._currentKeyframe[prop] = val;\n        });\n        Object.keys(this._localTimelineStyles).forEach(function (prop) {\n            if (!_this._currentKeyframe.hasOwnProperty(prop)) {\n                _this._currentKeyframe[prop] = _this._localTimelineStyles[prop];\n            }\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.snapshotCurrentStyles = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        Object.keys(this._localTimelineStyles).forEach(function (prop) {\n            var /** @type {?} */ val = _this._localTimelineStyles[prop];\n            _this._pendingStyles[prop] = val;\n            _this._updateStyle(prop, val);\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.getFinalKeyframe = /**\n     * @return {?}\n     */\n    function () { return this._keyframes.get(this.duration); };\n    Object.defineProperty(TimelineBuilder.prototype, \"properties\", {\n        get: /**\n         * @return {?}\n         */\n        function () {\n            var /** @type {?} */ properties = [];\n            for (var /** @type {?} */ prop in this._currentKeyframe) {\n                properties.push(prop);\n            }\n            return properties;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} timeline\n     * @return {?}\n     */\n    TimelineBuilder.prototype.mergeTimelineCollectedStyles = /**\n     * @param {?} timeline\n     * @return {?}\n     */\n    function (timeline) {\n        var _this = this;\n        Object.keys(timeline._styleSummary).forEach(function (prop) {\n            var /** @type {?} */ details0 = _this._styleSummary[prop];\n            var /** @type {?} */ details1 = timeline._styleSummary[prop];\n            if (!details0 || details1.time > details0.time) {\n                _this._updateStyle(prop, details1.value);\n            }\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.buildKeyframes = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        this.applyStylesToKeyframe();\n        var /** @type {?} */ preStyleProps = new Set();\n        var /** @type {?} */ postStyleProps = new Set();\n        var /** @type {?} */ isEmpty = this._keyframes.size === 1 && this.duration === 0;\n        var /** @type {?} */ finalKeyframes = [];\n        this._keyframes.forEach(function (keyframe, time) {\n            var /** @type {?} */ finalKeyframe = copyStyles(keyframe, true);\n            Object.keys(finalKeyframe).forEach(function (prop) {\n                var /** @type {?} */ value = finalKeyframe[prop];\n                if (value == _angular_animations.ɵPRE_STYLE) {\n                    preStyleProps.add(prop);\n                }\n                else if (value == _angular_animations.AUTO_STYLE) {\n                    postStyleProps.add(prop);\n                }\n            });\n            if (!isEmpty) {\n                finalKeyframe['offset'] = time / _this.duration;\n            }\n            finalKeyframes.push(finalKeyframe);\n        });\n        var /** @type {?} */ preProps = preStyleProps.size ? iteratorToArray(preStyleProps.values()) : [];\n        var /** @type {?} */ postProps = postStyleProps.size ? iteratorToArray(postStyleProps.values()) : [];\n        // special case for a 0-second animation (which is designed just to place styles onscreen)\n        if (isEmpty) {\n            var /** @type {?} */ kf0 = finalKeyframes[0];\n            var /** @type {?} */ kf1 = copyObj(kf0);\n            kf0['offset'] = 0;\n            kf1['offset'] = 1;\n            finalKeyframes = [kf0, kf1];\n        }\n        return createTimelineInstruction(this.element, finalKeyframes, preProps, postProps, this.duration, this.startTime, this.easing, false);\n    };\n    return TimelineBuilder;\n}());\nvar SubTimelineBuilder = (function (_super) {\n    __extends(SubTimelineBuilder, _super);\n    function SubTimelineBuilder(driver, element, keyframes, preStyleProps, postStyleProps, timings, _stretchStartingKeyframe) {\n        if (_stretchStartingKeyframe === void 0) { _stretchStartingKeyframe = false; }\n        var _this = _super.call(this, driver, element, timings.delay) || this;\n        _this.element = element;\n        _this.keyframes = keyframes;\n        _this.preStyleProps = preStyleProps;\n        _this.postStyleProps = postStyleProps;\n        _this._stretchStartingKeyframe = _stretchStartingKeyframe;\n        _this.timings = { duration: timings.duration, delay: timings.delay, easing: timings.easing };\n        return _this;\n    }\n    /**\n     * @return {?}\n     */\n    SubTimelineBuilder.prototype.containsAnimation = /**\n     * @return {?}\n     */\n    function () { return this.keyframes.length > 1; };\n    /**\n     * @return {?}\n     */\n    SubTimelineBuilder.prototype.buildKeyframes = /**\n     * @return {?}\n     */\n    function () {\n        var /** @type {?} */ keyframes = this.keyframes;\n        var _a = this.timings, delay = _a.delay, duration = _a.duration, easing = _a.easing;\n        if (this._stretchStartingKeyframe && delay) {\n            var /** @type {?} */ newKeyframes = [];\n            var /** @type {?} */ totalTime = duration + delay;\n            var /** @type {?} */ startingGap = delay / totalTime;\n            // the original starting keyframe now starts once the delay is done\n            var /** @type {?} */ newFirstKeyframe = copyStyles(keyframes[0], false);\n            newFirstKeyframe['offset'] = 0;\n            newKeyframes.push(newFirstKeyframe);\n            var /** @type {?} */ oldFirstKeyframe = copyStyles(keyframes[0], false);\n            oldFirstKeyframe['offset'] = roundOffset(startingGap);\n            newKeyframes.push(oldFirstKeyframe);\n            /*\n                    When the keyframe is stretched then it means that the delay before the animation\n                    starts is gone. Instead the first keyframe is placed at the start of the animation\n                    and it is then copied to where it starts when the original delay is over. This basically\n                    means nothing animates during that delay, but the styles are still renderered. For this\n                    to work the original offset values that exist in the original keyframes must be \"warped\"\n                    so that they can take the new keyframe + delay into account.\n            \n                    delay=1000, duration=1000, keyframes = 0 .5 1\n            \n                    turns into\n            \n                    delay=0, duration=2000, keyframes = 0 .33 .66 1\n                   */\n            // offsets between 1 ... n -1 are all warped by the keyframe stretch\n            var /** @type {?} */ limit = keyframes.length - 1;\n            for (var /** @type {?} */ i = 1; i <= limit; i++) {\n                var /** @type {?} */ kf = copyStyles(keyframes[i], false);\n                var /** @type {?} */ oldOffset = /** @type {?} */ (kf['offset']);\n                var /** @type {?} */ timeAtKeyframe = delay + oldOffset * duration;\n                kf['offset'] = roundOffset(timeAtKeyframe / totalTime);\n                newKeyframes.push(kf);\n            }\n            // the new starting keyframe should be added at the start\n            duration = totalTime;\n            delay = 0;\n            easing = '';\n            keyframes = newKeyframes;\n        }\n        return createTimelineInstruction(this.element, keyframes, this.preStyleProps, this.postStyleProps, duration, delay, easing, true);\n    };\n    return SubTimelineBuilder;\n}(TimelineBuilder));\n/**\n * @param {?} offset\n * @param {?=} decimalPoints\n * @return {?}\n */\nfunction roundOffset(offset, decimalPoints) {\n    if (decimalPoints === void 0) { decimalPoints = 3; }\n    var /** @type {?} */ mult = Math.pow(10, decimalPoints - 1);\n    return Math.round(offset * mult) / mult;\n}\n/**\n * @param {?} input\n * @param {?} allStyles\n * @return {?}\n */\nfunction flattenStyles(input, allStyles) {\n    var /** @type {?} */ styles = {};\n    var /** @type {?} */ allProperties;\n    input.forEach(function (token) {\n        if (token === '*') {\n            allProperties = allProperties || Object.keys(allStyles);\n            allProperties.forEach(function (prop) { styles[prop] = _angular_animations.AUTO_STYLE; });\n        }\n        else {\n            copyStyles(/** @type {?} */ (token), false, styles);\n        }\n    });\n    return styles;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar Animation = (function () {\n    function Animation(_driver, input) {\n        this._driver = _driver;\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ ast = buildAnimationAst(_driver, input, errors);\n        if (errors.length) {\n            var /** @type {?} */ errorMessage = \"animation validation failed:\\n\" + errors.join(\"\\n\");\n            throw new Error(errorMessage);\n        }\n        this._animationAst = ast;\n    }\n    /**\n     * @param {?} element\n     * @param {?} startingStyles\n     * @param {?} destinationStyles\n     * @param {?} options\n     * @param {?=} subInstructions\n     * @return {?}\n     */\n    Animation.prototype.buildTimelines = /**\n     * @param {?} element\n     * @param {?} startingStyles\n     * @param {?} destinationStyles\n     * @param {?} options\n     * @param {?=} subInstructions\n     * @return {?}\n     */\n    function (element, startingStyles, destinationStyles, options, subInstructions) {\n        var /** @type {?} */ start = Array.isArray(startingStyles) ? normalizeStyles(startingStyles) : /** @type {?} */ (startingStyles);\n        var /** @type {?} */ dest = Array.isArray(destinationStyles) ? normalizeStyles(destinationStyles) : /** @type {?} */ (destinationStyles);\n        var /** @type {?} */ errors = [];\n        subInstructions = subInstructions || new ElementInstructionMap();\n        var /** @type {?} */ result = buildAnimationTimelines(this._driver, element, this._animationAst, start, dest, options, subInstructions, errors);\n        if (errors.length) {\n            var /** @type {?} */ errorMessage = \"animation building failed:\\n\" + errors.join(\"\\n\");\n            throw new Error(errorMessage);\n        }\n        return result;\n    };\n    return Animation;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * \\@experimental Animation support is experimental.\n * @abstract\n */\nvar AnimationStyleNormalizer = (function () {\n    function AnimationStyleNormalizer() {\n    }\n    return AnimationStyleNormalizer;\n}());\n/**\n * \\@experimental Animation support is experimental.\n */\nvar NoopAnimationStyleNormalizer = (function () {\n    function NoopAnimationStyleNormalizer() {\n    }\n    /**\n     * @param {?} propertyName\n     * @param {?} errors\n     * @return {?}\n     */\n    NoopAnimationStyleNormalizer.prototype.normalizePropertyName = /**\n     * @param {?} propertyName\n     * @param {?} errors\n     * @return {?}\n     */\n    function (propertyName, errors) { return propertyName; };\n    /**\n     * @param {?} userProvidedProperty\n     * @param {?} normalizedProperty\n     * @param {?} value\n     * @param {?} errors\n     * @return {?}\n     */\n    NoopAnimationStyleNormalizer.prototype.normalizeStyleValue = /**\n     * @param {?} userProvidedProperty\n     * @param {?} normalizedProperty\n     * @param {?} value\n     * @param {?} errors\n     * @return {?}\n     */\n    function (userProvidedProperty, normalizedProperty, value, errors) {\n        return /** @type {?} */ (value);\n    };\n    return NoopAnimationStyleNormalizer;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar WebAnimationsStyleNormalizer = (function (_super) {\n    __extends(WebAnimationsStyleNormalizer, _super);\n    function WebAnimationsStyleNormalizer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * @param {?} propertyName\n     * @param {?} errors\n     * @return {?}\n     */\n    WebAnimationsStyleNormalizer.prototype.normalizePropertyName = /**\n     * @param {?} propertyName\n     * @param {?} errors\n     * @return {?}\n     */\n    function (propertyName, errors) {\n        return dashCaseToCamelCase(propertyName);\n    };\n    /**\n     * @param {?} userProvidedProperty\n     * @param {?} normalizedProperty\n     * @param {?} value\n     * @param {?} errors\n     * @return {?}\n     */\n    WebAnimationsStyleNormalizer.prototype.normalizeStyleValue = /**\n     * @param {?} userProvidedProperty\n     * @param {?} normalizedProperty\n     * @param {?} value\n     * @param {?} errors\n     * @return {?}\n     */\n    function (userProvidedProperty, normalizedProperty, value, errors) {\n        var /** @type {?} */ unit = '';\n        var /** @type {?} */ strVal = value.toString().trim();\n        if (DIMENSIONAL_PROP_MAP[normalizedProperty] && value !== 0 && value !== '0') {\n            if (typeof value === 'number') {\n                unit = 'px';\n            }\n            else {\n                var /** @type {?} */ valAndSuffixMatch = value.match(/^[+-]?[\\d\\.]+([a-z]*)$/);\n                if (valAndSuffixMatch && valAndSuffixMatch[1].length == 0) {\n                    errors.push(\"Please provide a CSS unit value for \" + userProvidedProperty + \":\" + value);\n                }\n            }\n        }\n        return strVal + unit;\n    };\n    return WebAnimationsStyleNormalizer;\n}(AnimationStyleNormalizer));\nvar DIMENSIONAL_PROP_MAP = makeBooleanMap('width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective'\n    .split(','));\n/**\n * @param {?} keys\n * @return {?}\n */\nfunction makeBooleanMap(keys) {\n    var /** @type {?} */ map = {};\n    keys.forEach(function (key) { return map[key] = true; });\n    return map;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @record\n */\n\n/**\n * @param {?} element\n * @param {?} triggerName\n * @param {?} fromState\n * @param {?} toState\n * @param {?} isRemovalTransition\n * @param {?} fromStyles\n * @param {?} toStyles\n * @param {?} timelines\n * @param {?} queriedElements\n * @param {?} preStyleProps\n * @param {?} postStyleProps\n * @param {?=} errors\n * @return {?}\n */\nfunction createTransitionInstruction(element, triggerName, fromState, toState, isRemovalTransition, fromStyles, toStyles, timelines, queriedElements, preStyleProps, postStyleProps, errors) {\n    return {\n        type: 0 /* TransitionAnimation */,\n        element: element,\n        triggerName: triggerName,\n        isRemovalTransition: isRemovalTransition,\n        fromState: fromState,\n        fromStyles: fromStyles,\n        toState: toState,\n        toStyles: toStyles,\n        timelines: timelines,\n        queriedElements: queriedElements,\n        preStyleProps: preStyleProps,\n        postStyleProps: postStyleProps,\n        errors: errors\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar EMPTY_OBJECT = {};\nvar AnimationTransitionFactory = (function () {\n    function AnimationTransitionFactory(_triggerName, ast, _stateStyles) {\n        this._triggerName = _triggerName;\n        this.ast = ast;\n        this._stateStyles = _stateStyles;\n    }\n    /**\n     * @param {?} currentState\n     * @param {?} nextState\n     * @return {?}\n     */\n    AnimationTransitionFactory.prototype.match = /**\n     * @param {?} currentState\n     * @param {?} nextState\n     * @return {?}\n     */\n    function (currentState, nextState) {\n        return oneOrMoreTransitionsMatch(this.ast.matchers, currentState, nextState);\n    };\n    /**\n     * @param {?} stateName\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationTransitionFactory.prototype.buildStyles = /**\n     * @param {?} stateName\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    function (stateName, params, errors) {\n        var /** @type {?} */ backupStateStyler = this._stateStyles['*'];\n        var /** @type {?} */ stateStyler = this._stateStyles[stateName];\n        var /** @type {?} */ backupStyles = backupStateStyler ? backupStateStyler.buildStyles(params, errors) : {};\n        return stateStyler ? stateStyler.buildStyles(params, errors) : backupStyles;\n    };\n    /**\n     * @param {?} driver\n     * @param {?} element\n     * @param {?} currentState\n     * @param {?} nextState\n     * @param {?=} currentOptions\n     * @param {?=} nextOptions\n     * @param {?=} subInstructions\n     * @return {?}\n     */\n    AnimationTransitionFactory.prototype.build = /**\n     * @param {?} driver\n     * @param {?} element\n     * @param {?} currentState\n     * @param {?} nextState\n     * @param {?=} currentOptions\n     * @param {?=} nextOptions\n     * @param {?=} subInstructions\n     * @return {?}\n     */\n    function (driver, element, currentState, nextState, currentOptions, nextOptions, subInstructions) {\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ transitionAnimationParams = this.ast.options && this.ast.options.params || EMPTY_OBJECT;\n        var /** @type {?} */ currentAnimationParams = currentOptions && currentOptions.params || EMPTY_OBJECT;\n        var /** @type {?} */ currentStateStyles = this.buildStyles(currentState, currentAnimationParams, errors);\n        var /** @type {?} */ nextAnimationParams = nextOptions && nextOptions.params || EMPTY_OBJECT;\n        var /** @type {?} */ nextStateStyles = this.buildStyles(nextState, nextAnimationParams, errors);\n        var /** @type {?} */ queriedElements = new Set();\n        var /** @type {?} */ preStyleMap = new Map();\n        var /** @type {?} */ postStyleMap = new Map();\n        var /** @type {?} */ isRemoval = nextState === 'void';\n        var /** @type {?} */ animationOptions = { params: __assign({}, transitionAnimationParams, nextAnimationParams) };\n        var /** @type {?} */ timelines = buildAnimationTimelines(driver, element, this.ast.animation, currentStateStyles, nextStateStyles, animationOptions, subInstructions, errors);\n        if (errors.length) {\n            return createTransitionInstruction(element, this._triggerName, currentState, nextState, isRemoval, currentStateStyles, nextStateStyles, [], [], preStyleMap, postStyleMap, errors);\n        }\n        timelines.forEach(function (tl) {\n            var /** @type {?} */ elm = tl.element;\n            var /** @type {?} */ preProps = getOrSetAsInMap(preStyleMap, elm, {});\n            tl.preStyleProps.forEach(function (prop) { return preProps[prop] = true; });\n            var /** @type {?} */ postProps = getOrSetAsInMap(postStyleMap, elm, {});\n            tl.postStyleProps.forEach(function (prop) { return postProps[prop] = true; });\n            if (elm !== element) {\n                queriedElements.add(elm);\n            }\n        });\n        var /** @type {?} */ queriedElementsList = iteratorToArray(queriedElements.values());\n        return createTransitionInstruction(element, this._triggerName, currentState, nextState, isRemoval, currentStateStyles, nextStateStyles, timelines, queriedElementsList, preStyleMap, postStyleMap);\n    };\n    return AnimationTransitionFactory;\n}());\n/**\n * @param {?} matchFns\n * @param {?} currentState\n * @param {?} nextState\n * @return {?}\n */\nfunction oneOrMoreTransitionsMatch(matchFns, currentState, nextState) {\n    return matchFns.some(function (fn) { return fn(currentState, nextState); });\n}\nvar AnimationStateStyles = (function () {\n    function AnimationStateStyles(styles, defaultParams) {\n        this.styles = styles;\n        this.defaultParams = defaultParams;\n    }\n    /**\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationStateStyles.prototype.buildStyles = /**\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    function (params, errors) {\n        var /** @type {?} */ finalStyles = {};\n        var /** @type {?} */ combinedParams = copyObj(this.defaultParams);\n        Object.keys(params).forEach(function (key) {\n            var /** @type {?} */ value = params[key];\n            if (value != null) {\n                combinedParams[key] = value;\n            }\n        });\n        this.styles.styles.forEach(function (value) {\n            if (typeof value !== 'string') {\n                var /** @type {?} */ styleObj_1 = /** @type {?} */ (value);\n                Object.keys(styleObj_1).forEach(function (prop) {\n                    var /** @type {?} */ val = styleObj_1[prop];\n                    if (val.length > 1) {\n                        val = interpolateParams(val, combinedParams, errors);\n                    }\n                    finalStyles[prop] = val;\n                });\n            }\n        });\n        return finalStyles;\n    };\n    return AnimationStateStyles;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * \\@experimental Animation support is experimental.\n * @param {?} name\n * @param {?} ast\n * @return {?}\n */\nfunction buildTrigger(name, ast) {\n    return new AnimationTrigger(name, ast);\n}\n/**\n * \\@experimental Animation support is experimental.\n */\nvar AnimationTrigger = (function () {\n    function AnimationTrigger(name, ast) {\n        var _this = this;\n        this.name = name;\n        this.ast = ast;\n        this.transitionFactories = [];\n        this.states = {};\n        ast.states.forEach(function (ast) {\n            var /** @type {?} */ defaultParams = (ast.options && ast.options.params) || {};\n            _this.states[ast.name] = new AnimationStateStyles(ast.style, defaultParams);\n        });\n        balanceProperties(this.states, 'true', '1');\n        balanceProperties(this.states, 'false', '0');\n        ast.transitions.forEach(function (ast) {\n            _this.transitionFactories.push(new AnimationTransitionFactory(name, ast, _this.states));\n        });\n        this.fallbackTransition = createFallbackTransition(name, this.states);\n    }\n    Object.defineProperty(AnimationTrigger.prototype, \"containsQueries\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return this.ast.queryCount > 0; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} currentState\n     * @param {?} nextState\n     * @return {?}\n     */\n    AnimationTrigger.prototype.matchTransition = /**\n     * @param {?} currentState\n     * @param {?} nextState\n     * @return {?}\n     */\n    function (currentState, nextState) {\n        var /** @type {?} */ entry = this.transitionFactories.find(function (f) { return f.match(currentState, nextState); });\n        return entry || null;\n    };\n    /**\n     * @param {?} currentState\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationTrigger.prototype.matchStyles = /**\n     * @param {?} currentState\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    function (currentState, params, errors) {\n        return this.fallbackTransition.buildStyles(currentState, params, errors);\n    };\n    return AnimationTrigger;\n}());\n/**\n * @param {?} triggerName\n * @param {?} states\n * @return {?}\n */\nfunction createFallbackTransition(triggerName, states) {\n    var /** @type {?} */ matchers = [function (fromState, toState) { return true; }];\n    var /** @type {?} */ animation = new SequenceAst([]);\n    var /** @type {?} */ transition = new TransitionAst(matchers, animation);\n    return new AnimationTransitionFactory(triggerName, transition, states);\n}\n/**\n * @param {?} obj\n * @param {?} key1\n * @param {?} key2\n * @return {?}\n */\nfunction balanceProperties(obj, key1, key2) {\n    if (obj.hasOwnProperty(key1)) {\n        if (!obj.hasOwnProperty(key2)) {\n            obj[key2] = obj[key1];\n        }\n    }\n    else if (obj.hasOwnProperty(key2)) {\n        obj[key1] = obj[key2];\n    }\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar EMPTY_INSTRUCTION_MAP = new ElementInstructionMap();\nvar TimelineAnimationEngine = (function () {\n    function TimelineAnimationEngine(_driver, _normalizer) {\n        this._driver = _driver;\n        this._normalizer = _normalizer;\n        this._animations = {};\n        this._playersById = {};\n        this.players = [];\n    }\n    /**\n     * @param {?} id\n     * @param {?} metadata\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.register = /**\n     * @param {?} id\n     * @param {?} metadata\n     * @return {?}\n     */\n    function (id, metadata) {\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ ast = buildAnimationAst(this._driver, metadata, errors);\n        if (errors.length) {\n            throw new Error(\"Unable to build the animation due to the following errors: \" + errors.join(\"\\n\"));\n        }\n        else {\n            this._animations[id] = ast;\n        }\n    };\n    /**\n     * @param {?} i\n     * @param {?} preStyles\n     * @param {?=} postStyles\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype._buildPlayer = /**\n     * @param {?} i\n     * @param {?} preStyles\n     * @param {?=} postStyles\n     * @return {?}\n     */\n    function (i, preStyles, postStyles) {\n        var /** @type {?} */ element = i.element;\n        var /** @type {?} */ keyframes = normalizeKeyframes(this._driver, this._normalizer, element, i.keyframes, preStyles, postStyles);\n        return this._driver.animate(element, keyframes, i.duration, i.delay, i.easing, []);\n    };\n    /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?=} options\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.create = /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?=} options\n     * @return {?}\n     */\n    function (id, element, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ ast = this._animations[id];\n        var /** @type {?} */ instructions;\n        var /** @type {?} */ autoStylesMap = new Map();\n        if (ast) {\n            instructions = buildAnimationTimelines(this._driver, element, ast, {}, {}, options, EMPTY_INSTRUCTION_MAP, errors);\n            instructions.forEach(function (inst) {\n                var /** @type {?} */ styles = getOrSetAsInMap(autoStylesMap, inst.element, {});\n                inst.postStyleProps.forEach(function (prop) { return styles[prop] = null; });\n            });\n        }\n        else {\n            errors.push('The requested animation doesn\\'t exist or has already been destroyed');\n            instructions = [];\n        }\n        if (errors.length) {\n            throw new Error(\"Unable to create the animation due to the following errors: \" + errors.join(\"\\n\"));\n        }\n        autoStylesMap.forEach(function (styles, element) {\n            Object.keys(styles).forEach(function (prop) { styles[prop] = _this._driver.computeStyle(element, prop, _angular_animations.AUTO_STYLE); });\n        });\n        var /** @type {?} */ players = instructions.map(function (i) {\n            var /** @type {?} */ styles = autoStylesMap.get(i.element);\n            return _this._buildPlayer(i, {}, styles);\n        });\n        var /** @type {?} */ player = optimizeGroupPlayer(players);\n        this._playersById[id] = player;\n        player.onDestroy(function () { return _this.destroy(id); });\n        this.players.push(player);\n        return player;\n    };\n    /**\n     * @param {?} id\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.destroy = /**\n     * @param {?} id\n     * @return {?}\n     */\n    function (id) {\n        var /** @type {?} */ player = this._getPlayer(id);\n        player.destroy();\n        delete this._playersById[id];\n        var /** @type {?} */ index = this.players.indexOf(player);\n        if (index >= 0) {\n            this.players.splice(index, 1);\n        }\n    };\n    /**\n     * @param {?} id\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype._getPlayer = /**\n     * @param {?} id\n     * @return {?}\n     */\n    function (id) {\n        var /** @type {?} */ player = this._playersById[id];\n        if (!player) {\n            throw new Error(\"Unable to find the timeline player referenced by \" + id);\n        }\n        return player;\n    };\n    /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?} eventName\n     * @param {?} callback\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.listen = /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?} eventName\n     * @param {?} callback\n     * @return {?}\n     */\n    function (id, element, eventName, callback) {\n        // triggerName, fromState, toState are all ignored for timeline animations\n        var /** @type {?} */ baseEvent = makeAnimationEvent(element, '', '', '');\n        listenOnPlayer(this._getPlayer(id), eventName, baseEvent, callback);\n        return function () { };\n    };\n    /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?} command\n     * @param {?} args\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.command = /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?} command\n     * @param {?} args\n     * @return {?}\n     */\n    function (id, element, command, args) {\n        if (command == 'register') {\n            this.register(id, /** @type {?} */ (args[0]));\n            return;\n        }\n        if (command == 'create') {\n            var /** @type {?} */ options = /** @type {?} */ ((args[0] || {}));\n            this.create(id, element, options);\n            return;\n        }\n        var /** @type {?} */ player = this._getPlayer(id);\n        switch (command) {\n            case 'play':\n                player.play();\n                break;\n            case 'pause':\n                player.pause();\n                break;\n            case 'reset':\n                player.reset();\n                break;\n            case 'restart':\n                player.restart();\n                break;\n            case 'finish':\n                player.finish();\n                break;\n            case 'init':\n                player.init();\n                break;\n            case 'setPosition':\n                player.setPosition(parseFloat(/** @type {?} */ (args[0])));\n                break;\n            case 'destroy':\n                this.destroy(id);\n                break;\n        }\n    };\n    return TimelineAnimationEngine;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar QUEUED_CLASSNAME = 'ng-animate-queued';\nvar QUEUED_SELECTOR = '.ng-animate-queued';\nvar DISABLED_CLASSNAME = 'ng-animate-disabled';\nvar DISABLED_SELECTOR = '.ng-animate-disabled';\nvar EMPTY_PLAYER_ARRAY = [];\nvar NULL_REMOVAL_STATE = {\n    namespaceId: '',\n    setForRemoval: null,\n    hasAnimation: false,\n    removedBeforeQueried: false\n};\nvar NULL_REMOVED_QUERIED_STATE = {\n    namespaceId: '',\n    setForRemoval: null,\n    hasAnimation: false,\n    removedBeforeQueried: true\n};\n/**\n * @record\n */\n\nvar REMOVAL_FLAG = '__ng_removed';\n/**\n * @record\n */\n\nvar StateValue = (function () {\n    function StateValue(input) {\n        var /** @type {?} */ isObj = input && input.hasOwnProperty('value');\n        var /** @type {?} */ value = isObj ? input['value'] : input;\n        this.value = normalizeTriggerValue(value);\n        if (isObj) {\n            var /** @type {?} */ options = copyObj(/** @type {?} */ (input));\n            delete options['value'];\n            this.options = /** @type {?} */ (options);\n        }\n        else {\n            this.options = {};\n        }\n        if (!this.options.params) {\n            this.options.params = {};\n        }\n    }\n    Object.defineProperty(StateValue.prototype, \"params\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return /** @type {?} */ (this.options.params); },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} options\n     * @return {?}\n     */\n    StateValue.prototype.absorbOptions = /**\n     * @param {?} options\n     * @return {?}\n     */\n    function (options) {\n        var /** @type {?} */ newParams = options.params;\n        if (newParams) {\n            var /** @type {?} */ oldParams_1 = /** @type {?} */ ((this.options.params));\n            Object.keys(newParams).forEach(function (prop) {\n                if (oldParams_1[prop] == null) {\n                    oldParams_1[prop] = newParams[prop];\n                }\n            });\n        }\n    };\n    return StateValue;\n}());\nvar VOID_VALUE = 'void';\nvar DEFAULT_STATE_VALUE = new StateValue(VOID_VALUE);\nvar DELETED_STATE_VALUE = new StateValue('DELETED');\nvar AnimationTransitionNamespace = (function () {\n    function AnimationTransitionNamespace(id, hostElement, _engine) {\n        this.id = id;\n        this.hostElement = hostElement;\n        this._engine = _engine;\n        this.players = [];\n        this._triggers = {};\n        this._queue = [];\n        this._elementListeners = new Map();\n        this._hostClassName = 'ng-tns-' + id;\n        addClass(hostElement, this._hostClassName);\n    }\n    /**\n     * @param {?} element\n     * @param {?} name\n     * @param {?} phase\n     * @param {?} callback\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.listen = /**\n     * @param {?} element\n     * @param {?} name\n     * @param {?} phase\n     * @param {?} callback\n     * @return {?}\n     */\n    function (element, name, phase, callback) {\n        var _this = this;\n        if (!this._triggers.hasOwnProperty(name)) {\n            throw new Error(\"Unable to listen on the animation trigger event \\\"\" + phase + \"\\\" because the animation trigger \\\"\" + name + \"\\\" doesn't exist!\");\n        }\n        if (phase == null || phase.length == 0) {\n            throw new Error(\"Unable to listen on the animation trigger \\\"\" + name + \"\\\" because the provided event is undefined!\");\n        }\n        if (!isTriggerEventValid(phase)) {\n            throw new Error(\"The provided animation trigger event \\\"\" + phase + \"\\\" for the animation trigger \\\"\" + name + \"\\\" is not supported!\");\n        }\n        var /** @type {?} */ listeners = getOrSetAsInMap(this._elementListeners, element, []);\n        var /** @type {?} */ data = { name: name, phase: phase, callback: callback };\n        listeners.push(data);\n        var /** @type {?} */ triggersWithStates = getOrSetAsInMap(this._engine.statesByElement, element, {});\n        if (!triggersWithStates.hasOwnProperty(name)) {\n            addClass(element, NG_TRIGGER_CLASSNAME);\n            addClass(element, NG_TRIGGER_CLASSNAME + '-' + name);\n            triggersWithStates[name] = null;\n        }\n        return function () {\n            // the event listener is removed AFTER the flush has occurred such\n            // that leave animations callbacks can fire (otherwise if the node\n            // is removed in between then the listeners would be deregistered)\n            // the event listener is removed AFTER the flush has occurred such\n            // that leave animations callbacks can fire (otherwise if the node\n            // is removed in between then the listeners would be deregistered)\n            _this._engine.afterFlush(function () {\n                var /** @type {?} */ index = listeners.indexOf(data);\n                if (index >= 0) {\n                    listeners.splice(index, 1);\n                }\n                if (!_this._triggers[name]) {\n                    delete triggersWithStates[name];\n                }\n            });\n        };\n    };\n    /**\n     * @param {?} name\n     * @param {?} ast\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.register = /**\n     * @param {?} name\n     * @param {?} ast\n     * @return {?}\n     */\n    function (name, ast) {\n        if (this._triggers[name]) {\n            // throw\n            return false;\n        }\n        else {\n            this._triggers[name] = ast;\n            return true;\n        }\n    };\n    /**\n     * @param {?} name\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype._getTrigger = /**\n     * @param {?} name\n     * @return {?}\n     */\n    function (name) {\n        var /** @type {?} */ trigger = this._triggers[name];\n        if (!trigger) {\n            throw new Error(\"The provided animation trigger \\\"\" + name + \"\\\" has not been registered!\");\n        }\n        return trigger;\n    };\n    /**\n     * @param {?} element\n     * @param {?} triggerName\n     * @param {?} value\n     * @param {?=} defaultToFallback\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.trigger = /**\n     * @param {?} element\n     * @param {?} triggerName\n     * @param {?} value\n     * @param {?=} defaultToFallback\n     * @return {?}\n     */\n    function (element, triggerName, value, defaultToFallback) {\n        var _this = this;\n        if (defaultToFallback === void 0) { defaultToFallback = true; }\n        var /** @type {?} */ trigger = this._getTrigger(triggerName);\n        var /** @type {?} */ player = new TransitionAnimationPlayer(this.id, triggerName, element);\n        var /** @type {?} */ triggersWithStates = this._engine.statesByElement.get(element);\n        if (!triggersWithStates) {\n            addClass(element, NG_TRIGGER_CLASSNAME);\n            addClass(element, NG_TRIGGER_CLASSNAME + '-' + triggerName);\n            this._engine.statesByElement.set(element, triggersWithStates = {});\n        }\n        var /** @type {?} */ fromState = triggersWithStates[triggerName];\n        var /** @type {?} */ toState = new StateValue(value);\n        var /** @type {?} */ isObj = value && value.hasOwnProperty('value');\n        if (!isObj && fromState) {\n            toState.absorbOptions(fromState.options);\n        }\n        triggersWithStates[triggerName] = toState;\n        if (!fromState) {\n            fromState = DEFAULT_STATE_VALUE;\n        }\n        else if (fromState === DELETED_STATE_VALUE) {\n            return player;\n        }\n        var /** @type {?} */ isRemoval = toState.value === VOID_VALUE;\n        // normally this isn't reached by here, however, if an object expression\n        // is passed in then it may be a new object each time. Comparing the value\n        // is important since that will stay the same despite there being a new object.\n        // The removal arc here is special cased because the same element is triggered\n        // twice in the event that it contains animations on the outer/inner portions\n        // of the host container\n        if (!isRemoval && fromState.value === toState.value) {\n            // this means that despite the value not changing, some inner params\n            // have changed which means that the animation final styles need to be applied\n            if (!objEquals(fromState.params, toState.params)) {\n                var /** @type {?} */ errors = [];\n                var /** @type {?} */ fromStyles_1 = trigger.matchStyles(fromState.value, fromState.params, errors);\n                var /** @type {?} */ toStyles_1 = trigger.matchStyles(toState.value, toState.params, errors);\n                if (errors.length) {\n                    this._engine.reportError(errors);\n                }\n                else {\n                    this._engine.afterFlush(function () {\n                        eraseStyles(element, fromStyles_1);\n                        setStyles(element, toStyles_1);\n                    });\n                }\n            }\n            return;\n        }\n        var /** @type {?} */ playersOnElement = getOrSetAsInMap(this._engine.playersByElement, element, []);\n        playersOnElement.forEach(function (player) {\n            // only remove the player if it is queued on the EXACT same trigger/namespace\n            // we only also deal with queued players here because if the animation has\n            // started then we want to keep the player alive until the flush happens\n            // (which is where the previousPlayers are passed into the new palyer)\n            if (player.namespaceId == _this.id && player.triggerName == triggerName && player.queued) {\n                player.destroy();\n            }\n        });\n        var /** @type {?} */ transition = trigger.matchTransition(fromState.value, toState.value);\n        var /** @type {?} */ isFallbackTransition = false;\n        if (!transition) {\n            if (!defaultToFallback)\n                return;\n            transition = trigger.fallbackTransition;\n            isFallbackTransition = true;\n        }\n        this._engine.totalQueuedPlayers++;\n        this._queue.push({ element: element, triggerName: triggerName, transition: transition, fromState: fromState, toState: toState, player: player, isFallbackTransition: isFallbackTransition });\n        if (!isFallbackTransition) {\n            addClass(element, QUEUED_CLASSNAME);\n            player.onStart(function () { removeClass(element, QUEUED_CLASSNAME); });\n        }\n        player.onDone(function () {\n            var /** @type {?} */ index = _this.players.indexOf(player);\n            if (index >= 0) {\n                _this.players.splice(index, 1);\n            }\n            var /** @type {?} */ players = _this._engine.playersByElement.get(element);\n            if (players) {\n                var /** @type {?} */ index_1 = players.indexOf(player);\n                if (index_1 >= 0) {\n                    players.splice(index_1, 1);\n                }\n            }\n        });\n        this.players.push(player);\n        playersOnElement.push(player);\n        return player;\n    };\n    /**\n     * @param {?} name\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.deregister = /**\n     * @param {?} name\n     * @return {?}\n     */\n    function (name) {\n        var _this = this;\n        delete this._triggers[name];\n        this._engine.statesByElement.forEach(function (stateMap, element) { delete stateMap[name]; });\n        this._elementListeners.forEach(function (listeners, element) {\n            _this._elementListeners.set(element, listeners.filter(function (entry) { return entry.name != name; }));\n        });\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.clearElementCache = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        this._engine.statesByElement.delete(element);\n        this._elementListeners.delete(element);\n        var /** @type {?} */ elementPlayers = this._engine.playersByElement.get(element);\n        if (elementPlayers) {\n            elementPlayers.forEach(function (player) { return player.destroy(); });\n            this._engine.playersByElement.delete(element);\n        }\n    };\n    /**\n     * @param {?} rootElement\n     * @param {?} context\n     * @param {?=} animate\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype._destroyInnerNodes = /**\n     * @param {?} rootElement\n     * @param {?} context\n     * @param {?=} animate\n     * @return {?}\n     */\n    function (rootElement, context, animate) {\n        var _this = this;\n        if (animate === void 0) { animate = false; }\n        this._engine.driver.query(rootElement, NG_TRIGGER_SELECTOR, true).forEach(function (elm) {\n            if (animate && containsClass(elm, _this._hostClassName)) {\n                var /** @type {?} */ innerNs = _this._engine.namespacesByHostElement.get(elm);\n                // special case for a host element with animations on the same element\n                if (innerNs) {\n                    innerNs.removeNode(elm, context, true);\n                }\n                _this.removeNode(elm, context, true);\n            }\n            else {\n                _this.clearElementCache(elm);\n            }\n        });\n    };\n    /**\n     * @param {?} element\n     * @param {?} context\n     * @param {?=} doNotRecurse\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.removeNode = /**\n     * @param {?} element\n     * @param {?} context\n     * @param {?=} doNotRecurse\n     * @return {?}\n     */\n    function (element, context, doNotRecurse) {\n        var _this = this;\n        var /** @type {?} */ engine = this._engine;\n        if (!doNotRecurse && element.childElementCount) {\n            this._destroyInnerNodes(element, context, true);\n        }\n        var /** @type {?} */ triggerStates = engine.statesByElement.get(element);\n        if (triggerStates) {\n            var /** @type {?} */ players_1 = [];\n            Object.keys(triggerStates).forEach(function (triggerName) {\n                // this check is here in the event that an element is removed\n                // twice (both on the host level and the component level)\n                if (_this._triggers[triggerName]) {\n                    var /** @type {?} */ player = _this.trigger(element, triggerName, VOID_VALUE, false);\n                    if (player) {\n                        players_1.push(player);\n                    }\n                }\n            });\n            if (players_1.length) {\n                engine.markElementAsRemoved(this.id, element, true, context);\n                optimizeGroupPlayer(players_1).onDone(function () { return engine.processLeaveNode(element); });\n                return;\n            }\n        }\n        // find the player that is animating and make sure that the\n        // removal is delayed until that player has completed\n        var /** @type {?} */ containsPotentialParentTransition = false;\n        if (engine.totalAnimations) {\n            var /** @type {?} */ currentPlayers = engine.players.length ? engine.playersByQueriedElement.get(element) : [];\n            // when this `if statement` does not continue forward it means that\n            // a previous animation query has selected the current element and\n            // is animating it. In this situation want to continue fowards and\n            // allow the element to be queued up for animation later.\n            if (currentPlayers && currentPlayers.length) {\n                containsPotentialParentTransition = true;\n            }\n            else {\n                var /** @type {?} */ parent_1 = element;\n                while (parent_1 = parent_1.parentNode) {\n                    var /** @type {?} */ triggers = engine.statesByElement.get(parent_1);\n                    if (triggers) {\n                        containsPotentialParentTransition = true;\n                        break;\n                    }\n                }\n            }\n        }\n        // at this stage we know that the element will either get removed\n        // during flush or will be picked up by a parent query. Either way\n        // we need to fire the listeners for this element when it DOES get\n        // removed (once the query parent animation is done or after flush)\n        var /** @type {?} */ listeners = this._elementListeners.get(element);\n        if (listeners) {\n            var /** @type {?} */ visitedTriggers_1 = new Set();\n            listeners.forEach(function (listener) {\n                var /** @type {?} */ triggerName = listener.name;\n                if (visitedTriggers_1.has(triggerName))\n                    return;\n                visitedTriggers_1.add(triggerName);\n                var /** @type {?} */ trigger = _this._triggers[triggerName];\n                var /** @type {?} */ transition = trigger.fallbackTransition;\n                var /** @type {?} */ elementStates = /** @type {?} */ ((engine.statesByElement.get(element)));\n                var /** @type {?} */ fromState = elementStates[triggerName] || DEFAULT_STATE_VALUE;\n                var /** @type {?} */ toState = new StateValue(VOID_VALUE);\n                var /** @type {?} */ player = new TransitionAnimationPlayer(_this.id, triggerName, element);\n                _this._engine.totalQueuedPlayers++;\n                _this._queue.push({\n                    element: element,\n                    triggerName: triggerName,\n                    transition: transition,\n                    fromState: fromState,\n                    toState: toState,\n                    player: player,\n                    isFallbackTransition: true\n                });\n            });\n        }\n        // whether or not a parent has an animation we need to delay the deferral of the leave\n        // operation until we have more information (which we do after flush() has been called)\n        if (containsPotentialParentTransition) {\n            engine.markElementAsRemoved(this.id, element, false, context);\n        }\n        else {\n            // we do this after the flush has occurred such\n            // that the callbacks can be fired\n            engine.afterFlush(function () { return _this.clearElementCache(element); });\n            engine.destroyInnerAnimations(element);\n            engine._onRemovalComplete(element, context);\n        }\n    };\n    /**\n     * @param {?} element\n     * @param {?} parent\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.insertNode = /**\n     * @param {?} element\n     * @param {?} parent\n     * @return {?}\n     */\n    function (element, parent) { addClass(element, this._hostClassName); };\n    /**\n     * @param {?} microtaskId\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.drainQueuedTransitions = /**\n     * @param {?} microtaskId\n     * @return {?}\n     */\n    function (microtaskId) {\n        var _this = this;\n        var /** @type {?} */ instructions = [];\n        this._queue.forEach(function (entry) {\n            var /** @type {?} */ player = entry.player;\n            if (player.destroyed)\n                return;\n            var /** @type {?} */ element = entry.element;\n            var /** @type {?} */ listeners = _this._elementListeners.get(element);\n            if (listeners) {\n                listeners.forEach(function (listener) {\n                    if (listener.name == entry.triggerName) {\n                        var /** @type {?} */ baseEvent = makeAnimationEvent(element, entry.triggerName, entry.fromState.value, entry.toState.value);\n                        (/** @type {?} */ (baseEvent))['_data'] = microtaskId;\n                        listenOnPlayer(entry.player, listener.phase, baseEvent, listener.callback);\n                    }\n                });\n            }\n            if (player.markedForDestroy) {\n                _this._engine.afterFlush(function () {\n                    // now we can destroy the element properly since the event listeners have\n                    // been bound to the player\n                    player.destroy();\n                });\n            }\n            else {\n                instructions.push(entry);\n            }\n        });\n        this._queue = [];\n        return instructions.sort(function (a, b) {\n            // if depCount == 0 them move to front\n            // otherwise if a contains b then move back\n            var /** @type {?} */ d0 = a.transition.ast.depCount;\n            var /** @type {?} */ d1 = b.transition.ast.depCount;\n            if (d0 == 0 || d1 == 0) {\n                return d0 - d1;\n            }\n            return _this._engine.driver.containsElement(a.element, b.element) ? 1 : -1;\n        });\n    };\n    /**\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.destroy = /**\n     * @param {?} context\n     * @return {?}\n     */\n    function (context) {\n        this.players.forEach(function (p) { return p.destroy(); });\n        this._destroyInnerNodes(this.hostElement, context);\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.elementContainsData = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        var /** @type {?} */ containsData = false;\n        if (this._elementListeners.has(element))\n            containsData = true;\n        containsData =\n            (this._queue.find(function (entry) { return entry.element === element; }) ? true : false) || containsData;\n        return containsData;\n    };\n    return AnimationTransitionNamespace;\n}());\n/**\n * @record\n */\n\nvar TransitionAnimationEngine = (function () {\n    function TransitionAnimationEngine(driver, _normalizer) {\n        this.driver = driver;\n        this._normalizer = _normalizer;\n        this.players = [];\n        this.newHostElements = new Map();\n        this.playersByElement = new Map();\n        this.playersByQueriedElement = new Map();\n        this.statesByElement = new Map();\n        this.disabledNodes = new Set();\n        this.totalAnimations = 0;\n        this.totalQueuedPlayers = 0;\n        this._namespaceLookup = {};\n        this._namespaceList = [];\n        this._flushFns = [];\n        this._whenQuietFns = [];\n        this.namespacesByHostElement = new Map();\n        this.collectedEnterElements = [];\n        this.collectedLeaveElements = [];\n        this.onRemovalComplete = function (element, context) { };\n    }\n    /** @internal */\n    /**\n     * \\@internal\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._onRemovalComplete = /**\n     * \\@internal\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    function (element, context) { this.onRemovalComplete(element, context); };\n    Object.defineProperty(TransitionAnimationEngine.prototype, \"queuedPlayers\", {\n        get: /**\n         * @return {?}\n         */\n        function () {\n            var /** @type {?} */ players = [];\n            this._namespaceList.forEach(function (ns) {\n                ns.players.forEach(function (player) {\n                    if (player.queued) {\n                        players.push(player);\n                    }\n                });\n            });\n            return players;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.createNamespace = /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    function (namespaceId, hostElement) {\n        var /** @type {?} */ ns = new AnimationTransitionNamespace(namespaceId, hostElement, this);\n        if (hostElement.parentNode) {\n            this._balanceNamespaceList(ns, hostElement);\n        }\n        else {\n            // defer this later until flush during when the host element has\n            // been inserted so that we know exactly where to place it in\n            // the namespace list\n            this.newHostElements.set(hostElement, ns);\n            // given that this host element is apart of the animation code, it\n            // may or may not be inserted by a parent node that is an of an\n            // animation renderer type. If this happens then we can still have\n            // access to this item when we query for :enter nodes. If the parent\n            // is a renderer then the set data-structure will normalize the entry\n            this.collectEnterElement(hostElement);\n        }\n        return this._namespaceLookup[namespaceId] = ns;\n    };\n    /**\n     * @param {?} ns\n     * @param {?} hostElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._balanceNamespaceList = /**\n     * @param {?} ns\n     * @param {?} hostElement\n     * @return {?}\n     */\n    function (ns, hostElement) {\n        var /** @type {?} */ limit = this._namespaceList.length - 1;\n        if (limit >= 0) {\n            var /** @type {?} */ found = false;\n            for (var /** @type {?} */ i = limit; i >= 0; i--) {\n                var /** @type {?} */ nextNamespace = this._namespaceList[i];\n                if (this.driver.containsElement(nextNamespace.hostElement, hostElement)) {\n                    this._namespaceList.splice(i + 1, 0, ns);\n                    found = true;\n                    break;\n                }\n            }\n            if (!found) {\n                this._namespaceList.splice(0, 0, ns);\n            }\n        }\n        else {\n            this._namespaceList.push(ns);\n        }\n        this.namespacesByHostElement.set(hostElement, ns);\n        return ns;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.register = /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    function (namespaceId, hostElement) {\n        var /** @type {?} */ ns = this._namespaceLookup[namespaceId];\n        if (!ns) {\n            ns = this.createNamespace(namespaceId, hostElement);\n        }\n        return ns;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} name\n     * @param {?} trigger\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.registerTrigger = /**\n     * @param {?} namespaceId\n     * @param {?} name\n     * @param {?} trigger\n     * @return {?}\n     */\n    function (namespaceId, name, trigger) {\n        var /** @type {?} */ ns = this._namespaceLookup[namespaceId];\n        if (ns && ns.register(name, trigger)) {\n            this.totalAnimations++;\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} context\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.destroy = /**\n     * @param {?} namespaceId\n     * @param {?} context\n     * @return {?}\n     */\n    function (namespaceId, context) {\n        var _this = this;\n        if (!namespaceId)\n            return;\n        var /** @type {?} */ ns = this._fetchNamespace(namespaceId);\n        this.afterFlush(function () {\n            _this.namespacesByHostElement.delete(ns.hostElement);\n            delete _this._namespaceLookup[namespaceId];\n            var /** @type {?} */ index = _this._namespaceList.indexOf(ns);\n            if (index >= 0) {\n                _this._namespaceList.splice(index, 1);\n            }\n        });\n        this.afterFlushAnimationsDone(function () { return ns.destroy(context); });\n    };\n    /**\n     * @param {?} id\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._fetchNamespace = /**\n     * @param {?} id\n     * @return {?}\n     */\n    function (id) { return this._namespaceLookup[id]; };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} name\n     * @param {?} value\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.trigger = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} name\n     * @param {?} value\n     * @return {?}\n     */\n    function (namespaceId, element, name, value) {\n        if (isElementNode(element)) {\n            this._fetchNamespace(namespaceId).trigger(element, name, value);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} parent\n     * @param {?} insertBefore\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.insertNode = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} parent\n     * @param {?} insertBefore\n     * @return {?}\n     */\n    function (namespaceId, element, parent, insertBefore) {\n        if (!isElementNode(element))\n            return;\n        // special case for when an element is removed and reinserted (move operation)\n        // when this occurs we do not want to use the element for deletion later\n        var /** @type {?} */ details = /** @type {?} */ (element[REMOVAL_FLAG]);\n        if (details && details.setForRemoval) {\n            details.setForRemoval = false;\n        }\n        // in the event that the namespaceId is blank then the caller\n        // code does not contain any animation code in it, but it is\n        // just being called so that the node is marked as being inserted\n        if (namespaceId) {\n            this._fetchNamespace(namespaceId).insertNode(element, parent);\n        }\n        // only *directives and host elements are inserted before\n        if (insertBefore) {\n            this.collectEnterElement(element);\n        }\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.collectEnterElement = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) { this.collectedEnterElements.push(element); };\n    /**\n     * @param {?} element\n     * @param {?} value\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.markElementAsDisabled = /**\n     * @param {?} element\n     * @param {?} value\n     * @return {?}\n     */\n    function (element, value) {\n        if (value) {\n            if (!this.disabledNodes.has(element)) {\n                this.disabledNodes.add(element);\n                addClass(element, DISABLED_CLASSNAME);\n            }\n        }\n        else if (this.disabledNodes.has(element)) {\n            this.disabledNodes.delete(element);\n            removeClass(element, DISABLED_CLASSNAME);\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} context\n     * @param {?=} doNotRecurse\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.removeNode = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} context\n     * @param {?=} doNotRecurse\n     * @return {?}\n     */\n    function (namespaceId, element, context, doNotRecurse) {\n        if (!isElementNode(element)) {\n            this._onRemovalComplete(element, context);\n            return;\n        }\n        var /** @type {?} */ ns = namespaceId ? this._fetchNamespace(namespaceId) : null;\n        if (ns) {\n            ns.removeNode(element, context, doNotRecurse);\n        }\n        else {\n            this.markElementAsRemoved(namespaceId, element, false, context);\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?=} hasAnimation\n     * @param {?=} context\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.markElementAsRemoved = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?=} hasAnimation\n     * @param {?=} context\n     * @return {?}\n     */\n    function (namespaceId, element, hasAnimation, context) {\n        this.collectedLeaveElements.push(element);\n        element[REMOVAL_FLAG] = {\n            namespaceId: namespaceId,\n            setForRemoval: context, hasAnimation: hasAnimation,\n            removedBeforeQueried: false\n        };\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} name\n     * @param {?} phase\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.listen = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} name\n     * @param {?} phase\n     * @param {?} callback\n     * @return {?}\n     */\n    function (namespaceId, element, name, phase, callback) {\n        if (isElementNode(element)) {\n            return this._fetchNamespace(namespaceId).listen(element, name, phase, callback);\n        }\n        return function () { };\n    };\n    /**\n     * @param {?} entry\n     * @param {?} subTimelines\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._buildInstruction = /**\n     * @param {?} entry\n     * @param {?} subTimelines\n     * @return {?}\n     */\n    function (entry, subTimelines) {\n        return entry.transition.build(this.driver, entry.element, entry.fromState.value, entry.toState.value, entry.fromState.options, entry.toState.options, subTimelines);\n    };\n    /**\n     * @param {?} containerElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.destroyInnerAnimations = /**\n     * @param {?} containerElement\n     * @return {?}\n     */\n    function (containerElement) {\n        var _this = this;\n        var /** @type {?} */ elements = this.driver.query(containerElement, NG_TRIGGER_SELECTOR, true);\n        elements.forEach(function (element) {\n            var /** @type {?} */ players = _this.playersByElement.get(element);\n            if (players) {\n                players.forEach(function (player) {\n                    // special case for when an element is set for destruction, but hasn't started.\n                    // in this situation we want to delay the destruction until the flush occurs\n                    // so that any event listeners attached to the player are triggered.\n                    if (player.queued) {\n                        player.markedForDestroy = true;\n                    }\n                    else {\n                        player.destroy();\n                    }\n                });\n            }\n            var /** @type {?} */ stateMap = _this.statesByElement.get(element);\n            if (stateMap) {\n                Object.keys(stateMap).forEach(function (triggerName) { return stateMap[triggerName] = DELETED_STATE_VALUE; });\n            }\n        });\n        if (this.playersByQueriedElement.size == 0)\n            return;\n        elements = this.driver.query(containerElement, NG_ANIMATING_SELECTOR, true);\n        if (elements.length) {\n            elements.forEach(function (element) {\n                var /** @type {?} */ players = _this.playersByQueriedElement.get(element);\n                if (players) {\n                    players.forEach(function (player) { return player.finish(); });\n                }\n            });\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.whenRenderingDone = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            if (_this.players.length) {\n                return optimizeGroupPlayer(_this.players).onDone(function () { return resolve(); });\n            }\n            else {\n                resolve();\n            }\n        });\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.processLeaveNode = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        var _this = this;\n        var /** @type {?} */ details = /** @type {?} */ (element[REMOVAL_FLAG]);\n        if (details && details.setForRemoval) {\n            // this will prevent it from removing it twice\n            element[REMOVAL_FLAG] = NULL_REMOVAL_STATE;\n            if (details.namespaceId) {\n                this.destroyInnerAnimations(element);\n                var /** @type {?} */ ns = this._fetchNamespace(details.namespaceId);\n                if (ns) {\n                    ns.clearElementCache(element);\n                }\n            }\n            this._onRemovalComplete(element, details.setForRemoval);\n        }\n        if (this.driver.matchesElement(element, DISABLED_SELECTOR)) {\n            this.markElementAsDisabled(element, false);\n        }\n        this.driver.query(element, DISABLED_SELECTOR, true).forEach(function (node) {\n            _this.markElementAsDisabled(element, false);\n        });\n    };\n    /**\n     * @param {?=} microtaskId\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.flush = /**\n     * @param {?=} microtaskId\n     * @return {?}\n     */\n    function (microtaskId) {\n        var _this = this;\n        if (microtaskId === void 0) { microtaskId = -1; }\n        var /** @type {?} */ players = [];\n        if (this.newHostElements.size) {\n            this.newHostElements.forEach(function (ns, element) { return _this._balanceNamespaceList(ns, element); });\n            this.newHostElements.clear();\n        }\n        if (this._namespaceList.length &&\n            (this.totalQueuedPlayers || this.collectedLeaveElements.length)) {\n            var /** @type {?} */ cleanupFns = [];\n            try {\n                players = this._flushAnimations(cleanupFns, microtaskId);\n            }\n            finally {\n                for (var /** @type {?} */ i = 0; i < cleanupFns.length; i++) {\n                    cleanupFns[i]();\n                }\n            }\n        }\n        else {\n            for (var /** @type {?} */ i = 0; i < this.collectedLeaveElements.length; i++) {\n                var /** @type {?} */ element = this.collectedLeaveElements[i];\n                this.processLeaveNode(element);\n            }\n        }\n        this.totalQueuedPlayers = 0;\n        this.collectedEnterElements.length = 0;\n        this.collectedLeaveElements.length = 0;\n        this._flushFns.forEach(function (fn) { return fn(); });\n        this._flushFns = [];\n        if (this._whenQuietFns.length) {\n            // we move these over to a variable so that\n            // if any new callbacks are registered in another\n            // flush they do not populate the existing set\n            var /** @type {?} */ quietFns_1 = this._whenQuietFns;\n            this._whenQuietFns = [];\n            if (players.length) {\n                optimizeGroupPlayer(players).onDone(function () { quietFns_1.forEach(function (fn) { return fn(); }); });\n            }\n            else {\n                quietFns_1.forEach(function (fn) { return fn(); });\n            }\n        }\n    };\n    /**\n     * @param {?} errors\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.reportError = /**\n     * @param {?} errors\n     * @return {?}\n     */\n    function (errors) {\n        throw new Error(\"Unable to process animations due to the following failed trigger transitions\\n \" + errors.join(\"\\n\"));\n    };\n    /**\n     * @param {?} cleanupFns\n     * @param {?} microtaskId\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._flushAnimations = /**\n     * @param {?} cleanupFns\n     * @param {?} microtaskId\n     * @return {?}\n     */\n    function (cleanupFns, microtaskId) {\n        var _this = this;\n        var /** @type {?} */ subTimelines = new ElementInstructionMap();\n        var /** @type {?} */ skippedPlayers = [];\n        var /** @type {?} */ skippedPlayersMap = new Map();\n        var /** @type {?} */ queuedInstructions = [];\n        var /** @type {?} */ queriedElements = new Map();\n        var /** @type {?} */ allPreStyleElements = new Map();\n        var /** @type {?} */ allPostStyleElements = new Map();\n        var /** @type {?} */ disabledElementsSet = new Set();\n        this.disabledNodes.forEach(function (node) {\n            disabledElementsSet.add(node);\n            var /** @type {?} */ nodesThatAreDisabled = _this.driver.query(node, QUEUED_SELECTOR, true);\n            for (var /** @type {?} */ i = 0; i < nodesThatAreDisabled.length; i++) {\n                disabledElementsSet.add(nodesThatAreDisabled[i]);\n            }\n        });\n        var /** @type {?} */ bodyNode = getBodyNode();\n        var /** @type {?} */ allEnterNodes = this.collectedEnterElements.length ?\n            this.collectedEnterElements.filter(createIsRootFilterFn(this.collectedEnterElements)) :\n            [];\n        // this must occur before the instructions are built below such that\n        // the :enter queries match the elements (since the timeline queries\n        // are fired during instruction building).\n        for (var /** @type {?} */ i = 0; i < allEnterNodes.length; i++) {\n            addClass(allEnterNodes[i], ENTER_CLASSNAME);\n        }\n        var /** @type {?} */ allLeaveNodes = [];\n        var /** @type {?} */ leaveNodesWithoutAnimations = new Set();\n        for (var /** @type {?} */ i = 0; i < this.collectedLeaveElements.length; i++) {\n            var /** @type {?} */ element = this.collectedLeaveElements[i];\n            var /** @type {?} */ details = /** @type {?} */ (element[REMOVAL_FLAG]);\n            if (details && details.setForRemoval) {\n                addClass(element, LEAVE_CLASSNAME);\n                allLeaveNodes.push(element);\n                if (!details.hasAnimation) {\n                    leaveNodesWithoutAnimations.add(element);\n                }\n            }\n        }\n        cleanupFns.push(function () {\n            allEnterNodes.forEach(function (element) { return removeClass(element, ENTER_CLASSNAME); });\n            allLeaveNodes.forEach(function (element) {\n                removeClass(element, LEAVE_CLASSNAME);\n                _this.processLeaveNode(element);\n            });\n        });\n        var /** @type {?} */ allPlayers = [];\n        var /** @type {?} */ erroneousTransitions = [];\n        for (var /** @type {?} */ i = this._namespaceList.length - 1; i >= 0; i--) {\n            var /** @type {?} */ ns = this._namespaceList[i];\n            ns.drainQueuedTransitions(microtaskId).forEach(function (entry) {\n                var /** @type {?} */ player = entry.player;\n                allPlayers.push(player);\n                var /** @type {?} */ element = entry.element;\n                if (!bodyNode || !_this.driver.containsElement(bodyNode, element)) {\n                    player.destroy();\n                    return;\n                }\n                var /** @type {?} */ instruction = /** @type {?} */ ((_this._buildInstruction(entry, subTimelines)));\n                if (instruction.errors && instruction.errors.length) {\n                    erroneousTransitions.push(instruction);\n                    return;\n                }\n                // if a unmatched transition is queued to go then it SHOULD NOT render\n                // an animation and cancel the previously running animations.\n                if (entry.isFallbackTransition) {\n                    player.onStart(function () { return eraseStyles(element, instruction.fromStyles); });\n                    player.onDestroy(function () { return setStyles(element, instruction.toStyles); });\n                    skippedPlayers.push(player);\n                    return;\n                }\n                // this means that if a parent animation uses this animation as a sub trigger\n                // then it will instruct the timeline builder to not add a player delay, but\n                // instead stretch the first keyframe gap up until the animation starts. The\n                // reason this is important is to prevent extra initialization styles from being\n                // required by the user in the animation.\n                instruction.timelines.forEach(function (tl) { return tl.stretchStartingKeyframe = true; });\n                subTimelines.append(element, instruction.timelines);\n                var /** @type {?} */ tuple = { instruction: instruction, player: player, element: element };\n                queuedInstructions.push(tuple);\n                instruction.queriedElements.forEach(function (element) { return getOrSetAsInMap(queriedElements, element, []).push(player); });\n                instruction.preStyleProps.forEach(function (stringMap, element) {\n                    var /** @type {?} */ props = Object.keys(stringMap);\n                    if (props.length) {\n                        var /** @type {?} */ setVal_1 = /** @type {?} */ ((allPreStyleElements.get(element)));\n                        if (!setVal_1) {\n                            allPreStyleElements.set(element, setVal_1 = new Set());\n                        }\n                        props.forEach(function (prop) { return setVal_1.add(prop); });\n                    }\n                });\n                instruction.postStyleProps.forEach(function (stringMap, element) {\n                    var /** @type {?} */ props = Object.keys(stringMap);\n                    var /** @type {?} */ setVal = /** @type {?} */ ((allPostStyleElements.get(element)));\n                    if (!setVal) {\n                        allPostStyleElements.set(element, setVal = new Set());\n                    }\n                    props.forEach(function (prop) { return setVal.add(prop); });\n                });\n            });\n        }\n        if (erroneousTransitions.length) {\n            var /** @type {?} */ errors_1 = [];\n            erroneousTransitions.forEach(function (instruction) {\n                errors_1.push(\"@\" + instruction.triggerName + \" has failed due to:\\n\"); /** @type {?} */\n                ((instruction.errors)).forEach(function (error) { return errors_1.push(\"- \" + error + \"\\n\"); });\n            });\n            allPlayers.forEach(function (player) { return player.destroy(); });\n            this.reportError(errors_1);\n        }\n        // these can only be detected here since we have a map of all the elements\n        // that have animations attached to them... We use a set here in the event\n        // multiple enter captures on the same element were caught in different\n        // renderer namespaces (e.g. when a @trigger was on a host binding that had *ngIf)\n        var /** @type {?} */ enterNodesWithoutAnimations = new Set();\n        for (var /** @type {?} */ i = 0; i < allEnterNodes.length; i++) {\n            var /** @type {?} */ element = allEnterNodes[i];\n            if (!subTimelines.has(element)) {\n                enterNodesWithoutAnimations.add(element);\n            }\n        }\n        var /** @type {?} */ allPreviousPlayersMap = new Map();\n        var /** @type {?} */ sortedParentElements = [];\n        queuedInstructions.forEach(function (entry) {\n            var /** @type {?} */ element = entry.element;\n            if (subTimelines.has(element)) {\n                sortedParentElements.unshift(element);\n                _this._beforeAnimationBuild(entry.player.namespaceId, entry.instruction, allPreviousPlayersMap);\n            }\n        });\n        skippedPlayers.forEach(function (player) {\n            var /** @type {?} */ element = player.element;\n            var /** @type {?} */ previousPlayers = _this._getPreviousPlayers(element, false, player.namespaceId, player.triggerName, null);\n            previousPlayers.forEach(function (prevPlayer) {\n                getOrSetAsInMap(allPreviousPlayersMap, element, []).push(prevPlayer);\n                prevPlayer.destroy();\n            });\n        });\n        // this is a special case for nodes that will be removed (either by)\n        // having their own leave animations or by being queried in a container\n        // that will be removed once a parent animation is complete. The idea\n        // here is that * styles must be identical to ! styles because of\n        // backwards compatibility (* is also filled in by default in many places).\n        // Otherwise * styles will return an empty value or auto since the element\n        // that is being getComputedStyle'd will not be visible (since * = destination)\n        var /** @type {?} */ replaceNodes = allLeaveNodes.filter(function (node) {\n            return replacePostStylesAsPre(node, allPreStyleElements, allPostStyleElements);\n        });\n        // POST STAGE: fill the * styles\n        var _a = cloakAndComputeStyles(this.driver, leaveNodesWithoutAnimations, allPostStyleElements, _angular_animations.AUTO_STYLE), postStylesMap = _a[0], allLeaveQueriedNodes = _a[1];\n        allLeaveQueriedNodes.forEach(function (node) {\n            if (replacePostStylesAsPre(node, allPreStyleElements, allPostStyleElements)) {\n                replaceNodes.push(node);\n            }\n        });\n        // PRE STAGE: fill the ! styles\n        var preStylesMap = (allPreStyleElements.size ?\n            cloakAndComputeStyles(this.driver, enterNodesWithoutAnimations, allPreStyleElements, _angular_animations.ɵPRE_STYLE) :\n            [new Map()])[0];\n        replaceNodes.forEach(function (node) {\n            var /** @type {?} */ post = postStylesMap.get(node);\n            var /** @type {?} */ pre = preStylesMap.get(node);\n            postStylesMap.set(node, /** @type {?} */ (__assign({}, post, pre)));\n        });\n        var /** @type {?} */ rootPlayers = [];\n        var /** @type {?} */ subPlayers = [];\n        queuedInstructions.forEach(function (entry) {\n            var element = entry.element, player = entry.player, instruction = entry.instruction;\n            // this means that it was never consumed by a parent animation which\n            // means that it is independent and therefore should be set for animation\n            if (subTimelines.has(element)) {\n                if (disabledElementsSet.has(element)) {\n                    skippedPlayers.push(player);\n                    return;\n                }\n                var /** @type {?} */ innerPlayer = _this._buildAnimation(player.namespaceId, instruction, allPreviousPlayersMap, skippedPlayersMap, preStylesMap, postStylesMap);\n                player.setRealPlayer(innerPlayer);\n                var /** @type {?} */ parentHasPriority = null;\n                for (var /** @type {?} */ i = 0; i < sortedParentElements.length; i++) {\n                    var /** @type {?} */ parent_2 = sortedParentElements[i];\n                    if (parent_2 === element)\n                        break;\n                    if (_this.driver.containsElement(parent_2, element)) {\n                        parentHasPriority = parent_2;\n                        break;\n                    }\n                }\n                if (parentHasPriority) {\n                    var /** @type {?} */ parentPlayers = _this.playersByElement.get(parentHasPriority);\n                    if (parentPlayers && parentPlayers.length) {\n                        player.parentPlayer = optimizeGroupPlayer(parentPlayers);\n                    }\n                    skippedPlayers.push(player);\n                }\n                else {\n                    rootPlayers.push(player);\n                }\n            }\n            else {\n                eraseStyles(element, instruction.fromStyles);\n                player.onDestroy(function () { return setStyles(element, instruction.toStyles); });\n                // there still might be a ancestor player animating this\n                // element therefore we will still add it as a sub player\n                // even if its animation may be disabled\n                subPlayers.push(player);\n                if (disabledElementsSet.has(element)) {\n                    skippedPlayers.push(player);\n                }\n            }\n        });\n        // find all of the sub players' corresponding inner animation player\n        subPlayers.forEach(function (player) {\n            // even if any players are not found for a sub animation then it\n            // will still complete itself after the next tick since it's Noop\n            var /** @type {?} */ playersForElement = skippedPlayersMap.get(player.element);\n            if (playersForElement && playersForElement.length) {\n                var /** @type {?} */ innerPlayer = optimizeGroupPlayer(playersForElement);\n                player.setRealPlayer(innerPlayer);\n            }\n        });\n        // the reason why we don't actually play the animation is\n        // because all that a skipped player is designed to do is to\n        // fire the start/done transition callback events\n        skippedPlayers.forEach(function (player) {\n            if (player.parentPlayer) {\n                player.parentPlayer.onDestroy(function () { return player.destroy(); });\n            }\n            else {\n                player.destroy();\n            }\n        });\n        // run through all of the queued removals and see if they\n        // were picked up by a query. If not then perform the removal\n        // operation right away unless a parent animation is ongoing.\n        for (var /** @type {?} */ i = 0; i < allLeaveNodes.length; i++) {\n            var /** @type {?} */ element = allLeaveNodes[i];\n            var /** @type {?} */ details = /** @type {?} */ (element[REMOVAL_FLAG]);\n            removeClass(element, LEAVE_CLASSNAME);\n            // this means the element has a removal animation that is being\n            // taken care of and therefore the inner elements will hang around\n            // until that animation is over (or the parent queried animation)\n            if (details && details.hasAnimation)\n                continue;\n            var /** @type {?} */ players = [];\n            // if this element is queried or if it contains queried children\n            // then we want for the element not to be removed from the page\n            // until the queried animations have finished\n            if (queriedElements.size) {\n                var /** @type {?} */ queriedPlayerResults = queriedElements.get(element);\n                if (queriedPlayerResults && queriedPlayerResults.length) {\n                    players.push.apply(players, queriedPlayerResults);\n                }\n                var /** @type {?} */ queriedInnerElements = this.driver.query(element, NG_ANIMATING_SELECTOR, true);\n                for (var /** @type {?} */ j = 0; j < queriedInnerElements.length; j++) {\n                    var /** @type {?} */ queriedPlayers = queriedElements.get(queriedInnerElements[j]);\n                    if (queriedPlayers && queriedPlayers.length) {\n                        players.push.apply(players, queriedPlayers);\n                    }\n                }\n            }\n            var /** @type {?} */ activePlayers = players.filter(function (p) { return !p.destroyed; });\n            if (activePlayers.length) {\n                removeNodesAfterAnimationDone(this, element, activePlayers);\n            }\n            else {\n                this.processLeaveNode(element);\n            }\n        }\n        // this is required so the cleanup method doesn't remove them\n        allLeaveNodes.length = 0;\n        rootPlayers.forEach(function (player) {\n            _this.players.push(player);\n            player.onDone(function () {\n                player.destroy();\n                var /** @type {?} */ index = _this.players.indexOf(player);\n                _this.players.splice(index, 1);\n            });\n            player.play();\n        });\n        return rootPlayers;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.elementContainsData = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @return {?}\n     */\n    function (namespaceId, element) {\n        var /** @type {?} */ containsData = false;\n        var /** @type {?} */ details = /** @type {?} */ (element[REMOVAL_FLAG]);\n        if (details && details.setForRemoval)\n            containsData = true;\n        if (this.playersByElement.has(element))\n            containsData = true;\n        if (this.playersByQueriedElement.has(element))\n            containsData = true;\n        if (this.statesByElement.has(element))\n            containsData = true;\n        return this._fetchNamespace(namespaceId).elementContainsData(element) || containsData;\n    };\n    /**\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.afterFlush = /**\n     * @param {?} callback\n     * @return {?}\n     */\n    function (callback) { this._flushFns.push(callback); };\n    /**\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.afterFlushAnimationsDone = /**\n     * @param {?} callback\n     * @return {?}\n     */\n    function (callback) { this._whenQuietFns.push(callback); };\n    /**\n     * @param {?} element\n     * @param {?} isQueriedElement\n     * @param {?=} namespaceId\n     * @param {?=} triggerName\n     * @param {?=} toStateValue\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._getPreviousPlayers = /**\n     * @param {?} element\n     * @param {?} isQueriedElement\n     * @param {?=} namespaceId\n     * @param {?=} triggerName\n     * @param {?=} toStateValue\n     * @return {?}\n     */\n    function (element, isQueriedElement, namespaceId, triggerName, toStateValue) {\n        var /** @type {?} */ players = [];\n        if (isQueriedElement) {\n            var /** @type {?} */ queriedElementPlayers = this.playersByQueriedElement.get(element);\n            if (queriedElementPlayers) {\n                players = queriedElementPlayers;\n            }\n        }\n        else {\n            var /** @type {?} */ elementPlayers = this.playersByElement.get(element);\n            if (elementPlayers) {\n                var /** @type {?} */ isRemovalAnimation_1 = !toStateValue || toStateValue == VOID_VALUE;\n                elementPlayers.forEach(function (player) {\n                    if (player.queued)\n                        return;\n                    if (!isRemovalAnimation_1 && player.triggerName != triggerName)\n                        return;\n                    players.push(player);\n                });\n            }\n        }\n        if (namespaceId || triggerName) {\n            players = players.filter(function (player) {\n                if (namespaceId && namespaceId != player.namespaceId)\n                    return false;\n                if (triggerName && triggerName != player.triggerName)\n                    return false;\n                return true;\n            });\n        }\n        return players;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} instruction\n     * @param {?} allPreviousPlayersMap\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._beforeAnimationBuild = /**\n     * @param {?} namespaceId\n     * @param {?} instruction\n     * @param {?} allPreviousPlayersMap\n     * @return {?}\n     */\n    function (namespaceId, instruction, allPreviousPlayersMap) {\n        var _this = this;\n        var /** @type {?} */ triggerName = instruction.triggerName;\n        var /** @type {?} */ rootElement = instruction.element;\n        // when a removal animation occurs, ALL previous players are collected\n        // and destroyed (even if they are outside of the current namespace)\n        var /** @type {?} */ targetNameSpaceId = instruction.isRemovalTransition ? undefined : namespaceId;\n        var /** @type {?} */ targetTriggerName = instruction.isRemovalTransition ? undefined : triggerName;\n        instruction.timelines.map(function (timelineInstruction) {\n            var /** @type {?} */ element = timelineInstruction.element;\n            var /** @type {?} */ isQueriedElement = element !== rootElement;\n            var /** @type {?} */ players = getOrSetAsInMap(allPreviousPlayersMap, element, []);\n            var /** @type {?} */ previousPlayers = _this._getPreviousPlayers(element, isQueriedElement, targetNameSpaceId, targetTriggerName, instruction.toState);\n            previousPlayers.forEach(function (player) {\n                var /** @type {?} */ realPlayer = /** @type {?} */ (player.getRealPlayer());\n                if (realPlayer.beforeDestroy) {\n                    realPlayer.beforeDestroy();\n                }\n                player.destroy();\n                players.push(player);\n            });\n        });\n        // this needs to be done so that the PRE/POST styles can be\n        // computed properly without interfering with the previous animation\n        eraseStyles(rootElement, instruction.fromStyles);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} instruction\n     * @param {?} allPreviousPlayersMap\n     * @param {?} skippedPlayersMap\n     * @param {?} preStylesMap\n     * @param {?} postStylesMap\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._buildAnimation = /**\n     * @param {?} namespaceId\n     * @param {?} instruction\n     * @param {?} allPreviousPlayersMap\n     * @param {?} skippedPlayersMap\n     * @param {?} preStylesMap\n     * @param {?} postStylesMap\n     * @return {?}\n     */\n    function (namespaceId, instruction, allPreviousPlayersMap, skippedPlayersMap, preStylesMap, postStylesMap) {\n        var _this = this;\n        var /** @type {?} */ triggerName = instruction.triggerName;\n        var /** @type {?} */ rootElement = instruction.element;\n        // we first run this so that the previous animation player\n        // data can be passed into the successive animation players\n        var /** @type {?} */ allQueriedPlayers = [];\n        var /** @type {?} */ allConsumedElements = new Set();\n        var /** @type {?} */ allSubElements = new Set();\n        var /** @type {?} */ allNewPlayers = instruction.timelines.map(function (timelineInstruction) {\n            var /** @type {?} */ element = timelineInstruction.element;\n            allConsumedElements.add(element);\n            // FIXME (matsko): make sure to-be-removed animations are removed properly\n            var /** @type {?} */ details = element[REMOVAL_FLAG];\n            if (details && details.removedBeforeQueried)\n                return new _angular_animations.NoopAnimationPlayer();\n            var /** @type {?} */ isQueriedElement = element !== rootElement;\n            var /** @type {?} */ previousPlayers = flattenGroupPlayers((allPreviousPlayersMap.get(element) || EMPTY_PLAYER_ARRAY)\n                .map(function (p) { return p.getRealPlayer(); }))\n                .filter(function (p) {\n                // the `element` is not apart of the AnimationPlayer definition, but\n                // Mock/WebAnimations\n                // use the element within their implementation. This will be added in Angular5 to\n                // AnimationPlayer\n                var /** @type {?} */ pp = /** @type {?} */ (p);\n                return pp.element ? pp.element === element : false;\n            });\n            var /** @type {?} */ preStyles = preStylesMap.get(element);\n            var /** @type {?} */ postStyles = postStylesMap.get(element);\n            var /** @type {?} */ keyframes = normalizeKeyframes(_this.driver, _this._normalizer, element, timelineInstruction.keyframes, preStyles, postStyles);\n            var /** @type {?} */ player = _this._buildPlayer(timelineInstruction, keyframes, previousPlayers);\n            // this means that this particular player belongs to a sub trigger. It is\n            // important that we match this player up with the corresponding (@trigger.listener)\n            if (timelineInstruction.subTimeline && skippedPlayersMap) {\n                allSubElements.add(element);\n            }\n            if (isQueriedElement) {\n                var /** @type {?} */ wrappedPlayer = new TransitionAnimationPlayer(namespaceId, triggerName, element);\n                wrappedPlayer.setRealPlayer(player);\n                allQueriedPlayers.push(wrappedPlayer);\n            }\n            return player;\n        });\n        allQueriedPlayers.forEach(function (player) {\n            getOrSetAsInMap(_this.playersByQueriedElement, player.element, []).push(player);\n            player.onDone(function () { return deleteOrUnsetInMap(_this.playersByQueriedElement, player.element, player); });\n        });\n        allConsumedElements.forEach(function (element) { return addClass(element, NG_ANIMATING_CLASSNAME); });\n        var /** @type {?} */ player = optimizeGroupPlayer(allNewPlayers);\n        player.onDestroy(function () {\n            allConsumedElements.forEach(function (element) { return removeClass(element, NG_ANIMATING_CLASSNAME); });\n            setStyles(rootElement, instruction.toStyles);\n        });\n        // this basically makes all of the callbacks for sub element animations\n        // be dependent on the upper players for when they finish\n        allSubElements.forEach(function (element) { getOrSetAsInMap(skippedPlayersMap, element, []).push(player); });\n        return player;\n    };\n    /**\n     * @param {?} instruction\n     * @param {?} keyframes\n     * @param {?} previousPlayers\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._buildPlayer = /**\n     * @param {?} instruction\n     * @param {?} keyframes\n     * @param {?} previousPlayers\n     * @return {?}\n     */\n    function (instruction, keyframes, previousPlayers) {\n        if (keyframes.length > 0) {\n            return this.driver.animate(instruction.element, keyframes, instruction.duration, instruction.delay, instruction.easing, previousPlayers);\n        }\n        // special case for when an empty transition|definition is provided\n        // ... there is no point in rendering an empty animation\n        return new _angular_animations.NoopAnimationPlayer();\n    };\n    return TransitionAnimationEngine;\n}());\nvar TransitionAnimationPlayer = (function () {\n    function TransitionAnimationPlayer(namespaceId, triggerName, element) {\n        this.namespaceId = namespaceId;\n        this.triggerName = triggerName;\n        this.element = element;\n        this._player = new _angular_animations.NoopAnimationPlayer();\n        this._containsRealPlayer = false;\n        this._queuedCallbacks = {};\n        this.destroyed = false;\n        this.markedForDestroy = false;\n    }\n    Object.defineProperty(TransitionAnimationPlayer.prototype, \"queued\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return this._containsRealPlayer == false; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} player\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.setRealPlayer = /**\n     * @param {?} player\n     * @return {?}\n     */\n    function (player) {\n        var _this = this;\n        if (this._containsRealPlayer)\n            return;\n        this._player = player;\n        Object.keys(this._queuedCallbacks).forEach(function (phase) {\n            _this._queuedCallbacks[phase].forEach(function (callback) { return listenOnPlayer(player, phase, undefined, callback); });\n        });\n        this._queuedCallbacks = {};\n        this._containsRealPlayer = true;\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.getRealPlayer = /**\n     * @return {?}\n     */\n    function () { return this._player; };\n    /**\n     * @param {?} name\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype._queueEvent = /**\n     * @param {?} name\n     * @param {?} callback\n     * @return {?}\n     */\n    function (name, callback) {\n        getOrSetAsInMap(this._queuedCallbacks, name, []).push(callback);\n    };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.onDone = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) {\n        if (this.queued) {\n            this._queueEvent('done', fn);\n        }\n        this._player.onDone(fn);\n    };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.onStart = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) {\n        if (this.queued) {\n            this._queueEvent('start', fn);\n        }\n        this._player.onStart(fn);\n    };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.onDestroy = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) {\n        if (this.queued) {\n            this._queueEvent('destroy', fn);\n        }\n        this._player.onDestroy(fn);\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.init = /**\n     * @return {?}\n     */\n    function () { this._player.init(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.hasStarted = /**\n     * @return {?}\n     */\n    function () { return this.queued ? false : this._player.hasStarted(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.play = /**\n     * @return {?}\n     */\n    function () { !this.queued && this._player.play(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.pause = /**\n     * @return {?}\n     */\n    function () { !this.queued && this._player.pause(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.restart = /**\n     * @return {?}\n     */\n    function () { !this.queued && this._player.restart(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.finish = /**\n     * @return {?}\n     */\n    function () { this._player.finish(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.destroy = /**\n     * @return {?}\n     */\n    function () {\n        (/** @type {?} */ (this)).destroyed = true;\n        this._player.destroy();\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.reset = /**\n     * @return {?}\n     */\n    function () { !this.queued && this._player.reset(); };\n    /**\n     * @param {?} p\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.setPosition = /**\n     * @param {?} p\n     * @return {?}\n     */\n    function (p) {\n        if (!this.queued) {\n            this._player.setPosition(p);\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.getPosition = /**\n     * @return {?}\n     */\n    function () { return this.queued ? 0 : this._player.getPosition(); };\n    Object.defineProperty(TransitionAnimationPlayer.prototype, \"totalTime\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return this._player.totalTime; },\n        enumerable: true,\n        configurable: true\n    });\n    return TransitionAnimationPlayer;\n}());\n/**\n * @param {?} map\n * @param {?} key\n * @param {?} value\n * @return {?}\n */\nfunction deleteOrUnsetInMap(map, key, value) {\n    var /** @type {?} */ currentValues;\n    if (map instanceof Map) {\n        currentValues = map.get(key);\n        if (currentValues) {\n            if (currentValues.length) {\n                var /** @type {?} */ index = currentValues.indexOf(value);\n                currentValues.splice(index, 1);\n            }\n            if (currentValues.length == 0) {\n                map.delete(key);\n            }\n        }\n    }\n    else {\n        currentValues = map[key];\n        if (currentValues) {\n            if (currentValues.length) {\n                var /** @type {?} */ index = currentValues.indexOf(value);\n                currentValues.splice(index, 1);\n            }\n            if (currentValues.length == 0) {\n                delete map[key];\n            }\n        }\n    }\n    return currentValues;\n}\n/**\n * @param {?} value\n * @return {?}\n */\nfunction normalizeTriggerValue(value) {\n    switch (typeof value) {\n        case 'boolean':\n            return value ? '1' : '0';\n        default:\n            return value != null ? value.toString() : null;\n    }\n}\n/**\n * @param {?} node\n * @return {?}\n */\nfunction isElementNode(node) {\n    return node && node['nodeType'] === 1;\n}\n/**\n * @param {?} eventName\n * @return {?}\n */\nfunction isTriggerEventValid(eventName) {\n    return eventName == 'start' || eventName == 'done';\n}\n/**\n * @param {?} element\n * @param {?=} value\n * @return {?}\n */\nfunction cloakElement(element, value) {\n    var /** @type {?} */ oldValue = element.style.display;\n    element.style.display = value != null ? value : 'none';\n    return oldValue;\n}\n/**\n * @param {?} driver\n * @param {?} elements\n * @param {?} elementPropsMap\n * @param {?} defaultStyle\n * @return {?}\n */\nfunction cloakAndComputeStyles(driver, elements, elementPropsMap, defaultStyle) {\n    var /** @type {?} */ cloakVals = [];\n    elements.forEach(function (element) { return cloakVals.push(cloakElement(element)); });\n    var /** @type {?} */ valuesMap = new Map();\n    var /** @type {?} */ failedElements = [];\n    elementPropsMap.forEach(function (props, element) {\n        var /** @type {?} */ styles = {};\n        props.forEach(function (prop) {\n            var /** @type {?} */ value = styles[prop] = driver.computeStyle(element, prop, defaultStyle);\n            // there is no easy way to detect this because a sub element could be removed\n            // by a parent animation element being detached.\n            if (!value || value.length == 0) {\n                element[REMOVAL_FLAG] = NULL_REMOVED_QUERIED_STATE;\n                failedElements.push(element);\n            }\n        });\n        valuesMap.set(element, styles);\n    });\n    // we use a index variable here since Set.forEach(a, i) does not return\n    // an index value for the closure (but instead just the value)\n    var /** @type {?} */ i = 0;\n    elements.forEach(function (element) { return cloakElement(element, cloakVals[i++]); });\n    return [valuesMap, failedElements];\n}\n/**\n * @param {?} nodes\n * @return {?}\n */\nfunction createIsRootFilterFn(nodes) {\n    var /** @type {?} */ nodeSet = new Set(nodes);\n    var /** @type {?} */ knownRootContainer = new Set();\n    var /** @type {?} */ isRoot;\n    isRoot = function (node) {\n        if (!node)\n            return true;\n        if (nodeSet.has(node.parentNode))\n            return false;\n        if (knownRootContainer.has(node.parentNode))\n            return true;\n        if (isRoot(node.parentNode)) {\n            knownRootContainer.add(node);\n            return true;\n        }\n        return false;\n    };\n    return isRoot;\n}\nvar CLASSES_CACHE_KEY = '$$classes';\n/**\n * @param {?} element\n * @param {?} className\n * @return {?}\n */\nfunction containsClass(element, className) {\n    if (element.classList) {\n        return element.classList.contains(className);\n    }\n    else {\n        var /** @type {?} */ classes = element[CLASSES_CACHE_KEY];\n        return classes && classes[className];\n    }\n}\n/**\n * @param {?} element\n * @param {?} className\n * @return {?}\n */\nfunction addClass(element, className) {\n    if (element.classList) {\n        element.classList.add(className);\n    }\n    else {\n        var /** @type {?} */ classes = element[CLASSES_CACHE_KEY];\n        if (!classes) {\n            classes = element[CLASSES_CACHE_KEY] = {};\n        }\n        classes[className] = true;\n    }\n}\n/**\n * @param {?} element\n * @param {?} className\n * @return {?}\n */\nfunction removeClass(element, className) {\n    if (element.classList) {\n        element.classList.remove(className);\n    }\n    else {\n        var /** @type {?} */ classes = element[CLASSES_CACHE_KEY];\n        if (classes) {\n            delete classes[className];\n        }\n    }\n}\n/**\n * @param {?} engine\n * @param {?} element\n * @param {?} players\n * @return {?}\n */\nfunction removeNodesAfterAnimationDone(engine, element, players) {\n    optimizeGroupPlayer(players).onDone(function () { return engine.processLeaveNode(element); });\n}\n/**\n * @param {?} players\n * @return {?}\n */\nfunction flattenGroupPlayers(players) {\n    var /** @type {?} */ finalPlayers = [];\n    _flattenGroupPlayersRecur(players, finalPlayers);\n    return finalPlayers;\n}\n/**\n * @param {?} players\n * @param {?} finalPlayers\n * @return {?}\n */\nfunction _flattenGroupPlayersRecur(players, finalPlayers) {\n    for (var /** @type {?} */ i = 0; i < players.length; i++) {\n        var /** @type {?} */ player = players[i];\n        if (player instanceof _angular_animations.ɵAnimationGroupPlayer) {\n            _flattenGroupPlayersRecur(player.players, finalPlayers);\n        }\n        else {\n            finalPlayers.push(/** @type {?} */ (player));\n        }\n    }\n}\n/**\n * @param {?} a\n * @param {?} b\n * @return {?}\n */\nfunction objEquals(a, b) {\n    var /** @type {?} */ k1 = Object.keys(a);\n    var /** @type {?} */ k2 = Object.keys(b);\n    if (k1.length != k2.length)\n        return false;\n    for (var /** @type {?} */ i = 0; i < k1.length; i++) {\n        var /** @type {?} */ prop = k1[i];\n        if (!b.hasOwnProperty(prop) || a[prop] !== b[prop])\n            return false;\n    }\n    return true;\n}\n/**\n * @param {?} element\n * @param {?} allPreStyleElements\n * @param {?} allPostStyleElements\n * @return {?}\n */\nfunction replacePostStylesAsPre(element, allPreStyleElements, allPostStyleElements) {\n    var /** @type {?} */ postEntry = allPostStyleElements.get(element);\n    if (!postEntry)\n        return false;\n    var /** @type {?} */ preEntry = allPreStyleElements.get(element);\n    if (preEntry) {\n        postEntry.forEach(function (data) { return /** @type {?} */ ((preEntry)).add(data); });\n    }\n    else {\n        allPreStyleElements.set(element, postEntry);\n    }\n    allPostStyleElements.delete(element);\n    return true;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar AnimationEngine = (function () {\n    function AnimationEngine(_driver, normalizer) {\n        var _this = this;\n        this._driver = _driver;\n        this._triggerCache = {};\n        this.onRemovalComplete = function (element, context) { };\n        this._transitionEngine = new TransitionAnimationEngine(_driver, normalizer);\n        this._timelineEngine = new TimelineAnimationEngine(_driver, normalizer);\n        this._transitionEngine.onRemovalComplete = function (element, context) {\n            return _this.onRemovalComplete(element, context);\n        };\n    }\n    /**\n     * @param {?} componentId\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @param {?} name\n     * @param {?} metadata\n     * @return {?}\n     */\n    AnimationEngine.prototype.registerTrigger = /**\n     * @param {?} componentId\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @param {?} name\n     * @param {?} metadata\n     * @return {?}\n     */\n    function (componentId, namespaceId, hostElement, name, metadata) {\n        var /** @type {?} */ cacheKey = componentId + '-' + name;\n        var /** @type {?} */ trigger = this._triggerCache[cacheKey];\n        if (!trigger) {\n            var /** @type {?} */ errors = [];\n            var /** @type {?} */ ast = /** @type {?} */ (buildAnimationAst(this._driver, /** @type {?} */ (metadata), errors));\n            if (errors.length) {\n                throw new Error(\"The animation trigger \\\"\" + name + \"\\\" has failed to build due to the following errors:\\n - \" + errors.join(\"\\n - \"));\n            }\n            trigger = buildTrigger(name, ast);\n            this._triggerCache[cacheKey] = trigger;\n        }\n        this._transitionEngine.registerTrigger(namespaceId, name, trigger);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    AnimationEngine.prototype.register = /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    function (namespaceId, hostElement) {\n        this._transitionEngine.register(namespaceId, hostElement);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationEngine.prototype.destroy = /**\n     * @param {?} namespaceId\n     * @param {?} context\n     * @return {?}\n     */\n    function (namespaceId, context) {\n        this._transitionEngine.destroy(namespaceId, context);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} parent\n     * @param {?} insertBefore\n     * @return {?}\n     */\n    AnimationEngine.prototype.onInsert = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} parent\n     * @param {?} insertBefore\n     * @return {?}\n     */\n    function (namespaceId, element, parent, insertBefore) {\n        this._transitionEngine.insertNode(namespaceId, element, parent, insertBefore);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationEngine.prototype.onRemove = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    function (namespaceId, element, context) {\n        this._transitionEngine.removeNode(namespaceId, element, context);\n    };\n    /**\n     * @param {?} element\n     * @param {?} disable\n     * @return {?}\n     */\n    AnimationEngine.prototype.disableAnimations = /**\n     * @param {?} element\n     * @param {?} disable\n     * @return {?}\n     */\n    function (element, disable) {\n        this._transitionEngine.markElementAsDisabled(element, disable);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} property\n     * @param {?} value\n     * @return {?}\n     */\n    AnimationEngine.prototype.process = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} property\n     * @param {?} value\n     * @return {?}\n     */\n    function (namespaceId, element, property, value) {\n        if (property.charAt(0) == '@') {\n            var _a = parseTimelineCommand(property), id = _a[0], action = _a[1];\n            var /** @type {?} */ args = /** @type {?} */ (value);\n            this._timelineEngine.command(id, element, action, args);\n        }\n        else {\n            this._transitionEngine.trigger(namespaceId, element, property, value);\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} eventName\n     * @param {?} eventPhase\n     * @param {?} callback\n     * @return {?}\n     */\n    AnimationEngine.prototype.listen = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} eventName\n     * @param {?} eventPhase\n     * @param {?} callback\n     * @return {?}\n     */\n    function (namespaceId, element, eventName, eventPhase, callback) {\n        // @@listen\n        if (eventName.charAt(0) == '@') {\n            var _a = parseTimelineCommand(eventName), id = _a[0], action = _a[1];\n            return this._timelineEngine.listen(id, element, action, callback);\n        }\n        return this._transitionEngine.listen(namespaceId, element, eventName, eventPhase, callback);\n    };\n    /**\n     * @param {?=} microtaskId\n     * @return {?}\n     */\n    AnimationEngine.prototype.flush = /**\n     * @param {?=} microtaskId\n     * @return {?}\n     */\n    function (microtaskId) {\n        if (microtaskId === void 0) { microtaskId = -1; }\n        this._transitionEngine.flush(microtaskId);\n    };\n    Object.defineProperty(AnimationEngine.prototype, \"players\", {\n        get: /**\n         * @return {?}\n         */\n        function () {\n            return (/** @type {?} */ (this._transitionEngine.players))\n                .concat(/** @type {?} */ (this._timelineEngine.players));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @return {?}\n     */\n    AnimationEngine.prototype.whenRenderingDone = /**\n     * @return {?}\n     */\n    function () { return this._transitionEngine.whenRenderingDone(); };\n    return AnimationEngine;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar WebAnimationsPlayer = (function () {\n    function WebAnimationsPlayer(element, keyframes, options, previousPlayers) {\n        if (previousPlayers === void 0) { previousPlayers = []; }\n        var _this = this;\n        this.element = element;\n        this.keyframes = keyframes;\n        this.options = options;\n        this.previousPlayers = previousPlayers;\n        this._onDoneFns = [];\n        this._onStartFns = [];\n        this._onDestroyFns = [];\n        this._initialized = false;\n        this._finished = false;\n        this._started = false;\n        this._destroyed = false;\n        this.time = 0;\n        this.parentPlayer = null;\n        this.previousStyles = {};\n        this.currentSnapshot = {};\n        this._duration = /** @type {?} */ (options['duration']);\n        this._delay = /** @type {?} */ (options['delay']) || 0;\n        this.time = this._duration + this._delay;\n        if (allowPreviousPlayerStylesMerge(this._duration, this._delay)) {\n            previousPlayers.forEach(function (player) {\n                var /** @type {?} */ styles = player.currentSnapshot;\n                Object.keys(styles).forEach(function (prop) { return _this.previousStyles[prop] = styles[prop]; });\n            });\n        }\n    }\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._onFinish = /**\n     * @return {?}\n     */\n    function () {\n        if (!this._finished) {\n            this._finished = true;\n            this._onDoneFns.forEach(function (fn) { return fn(); });\n            this._onDoneFns = [];\n        }\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.init = /**\n     * @return {?}\n     */\n    function () {\n        this._buildPlayer();\n        this._preparePlayerBeforeStart();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._buildPlayer = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        if (this._initialized)\n            return;\n        this._initialized = true;\n        var /** @type {?} */ keyframes = this.keyframes.map(function (styles) { return copyStyles(styles, false); });\n        var /** @type {?} */ previousStyleProps = Object.keys(this.previousStyles);\n        if (previousStyleProps.length) {\n            var /** @type {?} */ startingKeyframe_1 = keyframes[0];\n            var /** @type {?} */ missingStyleProps_1 = [];\n            previousStyleProps.forEach(function (prop) {\n                if (!startingKeyframe_1.hasOwnProperty(prop)) {\n                    missingStyleProps_1.push(prop);\n                }\n                startingKeyframe_1[prop] = _this.previousStyles[prop];\n            });\n            if (missingStyleProps_1.length) {\n                var /** @type {?} */ self_1 = this;\n                var _loop_1 = function () {\n                    var /** @type {?} */ kf = keyframes[i];\n                    missingStyleProps_1.forEach(function (prop) {\n                        kf[prop] = _computeStyle(self_1.element, prop);\n                    });\n                };\n                // tslint:disable-next-line\n                for (var /** @type {?} */ i = 1; i < keyframes.length; i++) {\n                    _loop_1();\n                }\n            }\n        }\n        (/** @type {?} */ (this)).domPlayer =\n            this._triggerWebAnimation(this.element, keyframes, this.options);\n        this._finalKeyframe = keyframes.length ? keyframes[keyframes.length - 1] : {};\n        this.domPlayer.addEventListener('finish', function () { return _this._onFinish(); });\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._preparePlayerBeforeStart = /**\n     * @return {?}\n     */\n    function () {\n        // this is required so that the player doesn't start to animate right away\n        if (this._delay) {\n            this._resetDomPlayerState();\n        }\n        else {\n            this.domPlayer.pause();\n        }\n    };\n    /** @internal */\n    /**\n     * \\@internal\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} options\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._triggerWebAnimation = /**\n     * \\@internal\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} options\n     * @return {?}\n     */\n    function (element, keyframes, options) {\n        // jscompiler doesn't seem to know animate is a native property because it's not fully\n        // supported yet across common browsers (we polyfill it for Edge/Safari) [CL #143630929]\n        return /** @type {?} */ (element['animate'](keyframes, options));\n    };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.onStart = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) { this._onStartFns.push(fn); };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.onDone = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) { this._onDoneFns.push(fn); };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.onDestroy = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) { this._onDestroyFns.push(fn); };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.play = /**\n     * @return {?}\n     */\n    function () {\n        this._buildPlayer();\n        if (!this.hasStarted()) {\n            this._onStartFns.forEach(function (fn) { return fn(); });\n            this._onStartFns = [];\n            this._started = true;\n        }\n        this.domPlayer.play();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.pause = /**\n     * @return {?}\n     */\n    function () {\n        this.init();\n        this.domPlayer.pause();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.finish = /**\n     * @return {?}\n     */\n    function () {\n        this.init();\n        this._onFinish();\n        this.domPlayer.finish();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.reset = /**\n     * @return {?}\n     */\n    function () {\n        this._resetDomPlayerState();\n        this._destroyed = false;\n        this._finished = false;\n        this._started = false;\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._resetDomPlayerState = /**\n     * @return {?}\n     */\n    function () {\n        if (this.domPlayer) {\n            this.domPlayer.cancel();\n        }\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.restart = /**\n     * @return {?}\n     */\n    function () {\n        this.reset();\n        this.play();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.hasStarted = /**\n     * @return {?}\n     */\n    function () { return this._started; };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.destroy = /**\n     * @return {?}\n     */\n    function () {\n        if (!this._destroyed) {\n            this._destroyed = true;\n            this._resetDomPlayerState();\n            this._onFinish();\n            this._onDestroyFns.forEach(function (fn) { return fn(); });\n            this._onDestroyFns = [];\n        }\n    };\n    /**\n     * @param {?} p\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.setPosition = /**\n     * @param {?} p\n     * @return {?}\n     */\n    function (p) { this.domPlayer.currentTime = p * this.time; };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.getPosition = /**\n     * @return {?}\n     */\n    function () { return this.domPlayer.currentTime / this.time; };\n    Object.defineProperty(WebAnimationsPlayer.prototype, \"totalTime\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return this._delay + this._duration; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.beforeDestroy = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        var /** @type {?} */ styles = {};\n        if (this.hasStarted()) {\n            Object.keys(this._finalKeyframe).forEach(function (prop) {\n                if (prop != 'offset') {\n                    styles[prop] =\n                        _this._finished ? _this._finalKeyframe[prop] : _computeStyle(_this.element, prop);\n                }\n            });\n        }\n        this.currentSnapshot = styles;\n    };\n    return WebAnimationsPlayer;\n}());\n/**\n * @param {?} element\n * @param {?} prop\n * @return {?}\n */\nfunction _computeStyle(element, prop) {\n    return (/** @type {?} */ (window.getComputedStyle(element)))[prop];\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar WebAnimationsDriver = (function () {\n    function WebAnimationsDriver() {\n    }\n    /**\n     * @param {?} prop\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.validateStyleProperty = /**\n     * @param {?} prop\n     * @return {?}\n     */\n    function (prop) { return validateStyleProperty(prop); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.matchesElement = /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    function (element, selector) {\n        return matchesElement(element, selector);\n    };\n    /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.containsElement = /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    function (elm1, elm2) { return containsElement(elm1, elm2); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.query = /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    function (element, selector, multi) {\n        return invokeQuery(element, selector, multi);\n    };\n    /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.computeStyle = /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    function (element, prop, defaultValue) {\n        return /** @type {?} */ ((/** @type {?} */ (window.getComputedStyle(element)))[prop]);\n    };\n    /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.animate = /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @return {?}\n     */\n    function (element, keyframes, duration, delay, easing, previousPlayers) {\n        if (previousPlayers === void 0) { previousPlayers = []; }\n        var /** @type {?} */ fill = delay == 0 ? 'both' : 'forwards';\n        var /** @type {?} */ playerOptions = { duration: duration, delay: delay, fill: fill };\n        // we check for this to avoid having a null|undefined value be present\n        // for the easing (which results in an error for certain browsers #9752)\n        if (easing) {\n            playerOptions['easing'] = easing;\n        }\n        var /** @type {?} */ previousWebAnimationPlayers = /** @type {?} */ (previousPlayers.filter(function (player) { return player instanceof WebAnimationsPlayer; }));\n        return new WebAnimationsPlayer(element, keyframes, playerOptions, previousWebAnimationPlayers);\n    };\n    return WebAnimationsDriver;\n}());\n/**\n * @return {?}\n */\nfunction supportsWebAnimations() {\n    return typeof Element !== 'undefined' && typeof (/** @type {?} */ (Element)).prototype['animate'] === 'function';\n}\n\nexports.AnimationDriver = AnimationDriver;\nexports.ɵAnimation = Animation;\nexports.ɵAnimationStyleNormalizer = AnimationStyleNormalizer;\nexports.ɵNoopAnimationStyleNormalizer = NoopAnimationStyleNormalizer;\nexports.ɵWebAnimationsStyleNormalizer = WebAnimationsStyleNormalizer;\nexports.ɵNoopAnimationDriver = NoopAnimationDriver;\nexports.ɵAnimationEngine = AnimationEngine;\nexports.ɵWebAnimationsDriver = WebAnimationsDriver;\nexports.ɵsupportsWebAnimations = supportsWebAnimations;\nexports.ɵWebAnimationsPlayer = WebAnimationsPlayer;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=animations-browser.umd.js.map\n"]}